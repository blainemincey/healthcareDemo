!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("stitch",[],t):"object"==typeof exports?exports.stitch=t():e.stitch=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=15)}([function(e,t,r){"use strict";function n(e,t){var r=t.serviceName,n=void 0===r?e.serviceName:r,i=t.action,o=t.args,u=e.client;if(!u)throw new Error("Service has no client");return u.executeServiceFunction(n,i,o)}function i(e){return encodeURIComponent(u.btoa(JSON.stringify(e)))}Object.defineProperty(t,"__esModule",{value:!0}),t.uriEncodeObject=t.serviceResponse=void 0;var o=r(12),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o);t.serviceResponse=n,t.uriEncodeObject=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.USER_AUTH_KEY="_stitch_ua",t.REFRESH_TOKEN_KEY="_stitch_rt",t.DEVICE_ID_KEY="_stitch_did",t.STATE_KEY="_stitch_state",t.USER_AUTH_COOKIE_NAME="stitch_ua",t.STITCH_ERROR_KEY="_stitch_error",t.STITCH_LINK_KEY="_stitch_link",t.USER_LOGGED_IN_PT_KEY="_stitch_pt",t.STITCH_REDIRECT_PROVIDER="_stitch_rp",t.DEFAULT_ACCESS_TOKEN_EXPIRE_WITHIN_SECS=10,t.APP_CLIENT_CODEC={accessToken:"access_token",refreshToken:"refresh_token",deviceId:"device_id",userId:"user_id"},t.ADMIN_CLIENT_CODEC={accessToken:"access_token",refreshToken:"refresh_token",deviceId:"device_id",userId:"user_id"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFetchArgs=t.checkStatus=t.SDK_VERSION=t.DEFAULT_STITCH_SERVER_URL=t.ADMIN_CLIENT_TYPE=t.APP_CLIENT_TYPE=t.JSONTYPE=void 0;var n=r(3),i=t.JSONTYPE="application/json",o=(t.APP_CLIENT_TYPE="app",t.ADMIN_CLIENT_TYPE="admin",t.DEFAULT_STITCH_SERVER_URL="https://stitch.mongodb.com","unknown");o="3.2.13";t.SDK_VERSION=o,t.checkStatus=function(e){if(e.status>=200&&e.status<300)return e;if(e.headers.get("Content-Type")===i)return e.json().then(function(t){var r=new n.StitchError(t.error,t.error_code);return r.response=e,r.json=t,Promise.reject(r)});var t=new Error(e.statusText);return t.response=e,Promise.reject(t)},t.makeFetchArgs=function(e,t){var r={method:e,headers:{Accept:i,"Content-Type":i}};return t&&(r.body=t),r.cors=!0,r}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this),this.message=e,this.name=this.constructor.name,void 0!==t&&(this.code=t)};u.prototype=Object.create(Error.prototype);var s=function(e){function t(){return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(u);t.StitchError=s,t.ErrAuthProviderNotFound="AuthProviderNotFound",t.ErrInvalidSession="InvalidSession",t.ErrUnauthorized="Unauthorized"},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){var r,n,o,u,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},f=Object.create(e),l=d.DEFAULT_STITCH_SERVER_URL;s.baseUrl&&(l=s.baseUrl),f.clientAppID=t,f.authUrl=t?l+"/api/client/v2.0/app/"+t+"/auth":l+"/api/admin/v3.0/auth",f.rootURLsByAPIVersion=(u={},i(u,m,(r={},i(r,E,l+"/api/public/v1.0"),i(r,w,l+"/api/client/v1.0"),i(r,O,l+"/api/private/v1.0"),i(r,N,t?l+"/api/client/v1.0/app/"+t:l+"/api/public/v1.0"),r)),i(u,B,(n={},i(n,E,l+"/api/public/v2.0"),i(n,w,l+"/api/client/v2.0"),i(n,O,l+"/api/private/v2.0"),i(n,N,t?l+"/api/client/v2.0/app/"+t:l+"/api/public/v2.0"),n)),i(u,S,(o={},i(o,E,l+"/api/public/v3.0"),i(o,w,l+"/api/client/v3.0"),i(o,N,t?l+"/api/client/v3.0/app/"+t:l+"/api/admin/v3.0"),o)),u);var h={codec:c.APP_CLIENT_CODEC,storage:s.storage};return s.storageType&&(h.storageType=s.storageType),s.platform&&(h.platform=s.platform),s.authCodec&&(h.codec=s.authCodec),a.AuthFactory.create(f,f.authUrl,h).then(function(e){return f.auth=e,Promise.all([f.auth.handleRedirect(),f.auth.handleCookie()])}).then(function(){return f})}Object.defineProperty(t,"__esModule",{value:!0}),t.StitchClient=t.StitchClientFactory=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.newStitchClient=u,r(9);var a=r(13),f=r(7),c=r(1),l=r(19),h=n(l),p=r(2),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(p),g=r(5),_=n(g),y=r(36),b=n(y),v=r(3),m=1,B=2,S=3,E="public",O="private",w="client",N="app",A=(t.StitchClientFactory=function(){function e(){throw o(this,e),new v.StitchError("StitchClient can only be made from the StitchClientFactory.create function")}return s(e,null,[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(A.prototype,e,t)}}]),e}(),t.StitchClient=function(){function e(){o(this,e);var t=this.constructor.name;throw new v.StitchError(t+" can only be made from the "+t+"Factory.create function")}return s(e,[{key:"login",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0===e||void 0===t?this.authenticate(f.PROVIDER_TYPE_ANON,r):this.authenticate("userpass",Object.assign({username:e,password:t},r))}},{key:"register",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.auth.provider("userpass").register(e,t,r)}},{key:"linkWithProvider",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isAuthenticated())throw new v.StitchError("Must be authenticated to link an account");return this.auth.provider(e).authenticate(r,!0).then(function(){return t.authedId()})}},{key:"authenticate",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){return t.auth.provider(e).authenticate(r).then(function(){return t.authedId()})};return this.isAuthenticated()?e===f.PROVIDER_TYPE_ANON&&this.auth.getLoggedInProviderType()===f.PROVIDER_TYPE_ANON?Promise.resolve(this.auth.authedId):this.logout().then(function(){return n()}):n()}},{key:"logout",value:function(){var e=this;return this._do("/auth/session","DELETE",{refreshOnFailure:!1,useRefreshToken:!0,rootURL:this.rootURLsByAPIVersion[B][w]}).then(function(){return e.auth.clear()},function(){return e.auth.clear()})}},{key:"authError",value:function(){return this.auth.error()}},{key:"userProfile",value:function(){return this._do("/auth/profile","GET",{rootURL:this.rootURLsByAPIVersion[B][w]}).then(function(e){return e.json()})}},{key:"isAuthenticated",value:function(){return!!this.authedId()}},{key:"authedId",value:function(){return this.auth.authedId}},{key:"service",value:function(t,r){if(this.constructor!==e)throw new v.StitchError("`service` is a factory method, do not use `new`");if(!h.default.hasOwnProperty(t))throw new v.StitchError("Invalid service type specified: "+t);return new(0,h.default[t])(this,r)}},{key:"executeFunction",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this._doFunctionCall({name:e,arguments:r})}},{key:"executeServiceFunction",value:function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this._doFunctionCall({service:e,name:t,arguments:n})}},{key:"_doFunctionCall",value:function(e){var t=function(e){return _.default.parse(e,{relaxed:!0})};return this._do("/functions/call","POST",{body:function(e){return _.default.stringify(e,{strict:!0})}(e)}).then(function(e){return e.text()}).then(function(e){return t(e)})}},{key:"doSessionPost",value:function(){return this._do("/auth/session","POST",{refreshOnFailure:!1,useRefreshToken:!0,rootURL:this.rootURLsByAPIVersion[B][w]}).then(function(e){return e.json()})}},{key:"getApiKeys",value:function(){return this._do("/auth/api_keys","GET",{rootURL:this.rootURLsByAPIVersion[B][w],useRefreshToken:!0}).then(function(e){return e.json()})}},{key:"createApiKey",value:function(e){return this._do("/auth/api_keys","POST",{rootURL:this.rootURLsByAPIVersion[B][w],useRefreshToken:!0,body:JSON.stringify({name:e})}).then(function(e){return e.json()})}},{key:"getApiKeyByID",value:function(e){return this._do("/auth/api_keys/"+e,"GET",{rootURL:this.rootURLsByAPIVersion[B][w],useRefreshToken:!0}).then(function(e){return e.json()})}},{key:"deleteApiKeyByID",value:function(e){return this._do("/auth/api_keys/"+e,"DELETE",{rootURL:this.rootURLsByAPIVersion[B][w],useRefreshToken:!0})}},{key:"enableApiKeyByID",value:function(e){return this._do("/auth/api_keys/"+e+"/enable","PUT",{rootURL:this.rootURLsByAPIVersion[B][w],useRefreshToken:!0})}},{key:"disableApiKeyByID",value:function(e){return this._do("/auth/api_keys/"+e+"/disable","PUT",{rootURL:this.rootURLsByAPIVersion[B][w],useRefreshToken:!0})}},{key:"_fetch",value:function(e,t,r,n,i){var o=this;return fetch(e,t).then(function(e){if(e.status>=200&&e.status<300)return Promise.resolve(e);if(e.headers.get("Content-Type")===d.JSONTYPE)return e.json().then(function(t){if("error_code"in t&&t.error_code===v.ErrInvalidSession)return i.refreshOnFailure?o.auth.refreshToken().then(function(){return i.refreshOnFailure=!1,o._do(r,n,i)}):o.auth.clear().then(function(){var r=new v.StitchError(t.error,t.error_code);throw r.response=e,r.json=t,r});var u=new v.StitchError(t.error,t.error_code);return u.response=e,u.json=t,Promise.reject(u)});var t=new Error(e.statusText);return t.response=e,Promise.reject(t)})}},{key:"_fetchArgs",value:function(e,t,r){var n=this.rootURLsByAPIVersion[r.apiVersion][r.apiType],i=""+n+e;r.rootURL&&(i=""+r.rootURL+e);var o=d.makeFetchArgs(t,r.body);return r.headers&&Object.assign(o.headers,r.headers),r.queryParams&&(i=i+"?"+b.default.stringify(r.queryParams)),r.multipart&&delete o.headers["Content-Type"],{url:i,fetchArgs:o}}},{key:"_do",value:function(e,t,r){r=Object.assign({},{refreshOnFailure:!0,useRefreshToken:!1,apiVersion:B,apiType:N,rootURL:void 0},r);var n=this._fetchArgs(e,t,r),i=n.url,o=n.fetchArgs;if(r.noAuth)return this._fetch(i,o,e,t,r);if(!this.isAuthenticated())return Promise.reject(new v.StitchError("Must auth first",v.ErrUnauthorized));var u=r.useRefreshToken?this.auth.getRefreshToken():this.auth.getAccessToken();return o.headers.Authorization="Bearer "+u,this._fetch(i,o,e,t,r)}},{key:"type",get:function(){return d.APP_CLIENT_TYPE}}]),e}())},function(e,t,r){"use strict";(function(n){var i,o,u,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(n,a){"object"===s(t)&&void 0!==e?e.exports=a(r(6)):(o=[r(6)],i=a,void 0!==(u="function"==typeof i?i.apply(t,o):i)&&(e.exports=u))}(0,function(e){function t(e){var t=Number(e).toString(16);return 1===t.length?"0"+t:t}function r(e){return{$binary:{base64:n.isBuffer(e.buffer)?e.buffer.toString("base64"):n.from(e.buffer).toString("base64"),subType:t(e.sub_type)}}}function i(e,t){var r=t.$binary.subType?parseInt(t.$binary.subType,16):0,i=new n(t.$binary.base64,"base64");return new e.Binary(i,r)}function o(e){return e.scope?{$code:e.code,$scope:e.scope}:{$code:e.code}}function u(e,t){return new e.Code(t.$code,t.$scope)}function a(e){var t={$ref:e.collection,$id:e.oid};return e.db&&(t.$db=e.db),t=Object.assign(t,e.fields)}function f(e,t){var r=Object.assign({},t);return["$ref","$id","$db"].forEach(function(e){return delete r[e]}),new e.DBRef(t.$ref,t.$id,t.$db,r)}function c(e){return{$numberDecimal:e.toString()}}function l(e,t){return new e.Decimal128.fromString(t.$numberDecimal)}function h(e,t){return t&&t.relaxed&&isFinite(e.value)?e.value:{$numberDouble:e.value.toString()}}function p(e,t,r){return r&&r.relaxed?parseFloat(t.$numberDouble):new e.Double(parseFloat(t.$numberDouble))}function d(e,t){return t&&t.relaxed?e.value:{$numberInt:e.value.toString()}}function g(e,t,r){return r&&r.relaxed?parseInt(t.$numberInt,10):new e.Int32(t.$numberInt)}function _(e,t){return t&&t.relaxed?e.toNumber():{$numberLong:e.toString()}}function y(e,t,r){var n=e.Long.fromString(t.$numberLong);return r&&r.relaxed?n.toNumber():n}function b(){return{$maxKey:1}}function v(e){return new e.MaxKey}function m(){return{$minKey:1}}function B(e){return new e.MinKey}function S(e){return e.toHexString?{$oid:e.toHexString()}:{$oid:e.toString("hex")}}function E(e,t){return new e.ObjectID(t.$oid)}function O(e){return{$regularExpression:{pattern:e.pattern,options:e.options}}}function w(e,t){return new e.BSONRegExp(t.$regularExpression.pattern,t.$regularExpression.options.split("").sort().join(""))}function N(e){return{$symbol:e.value}}function A(e,t){return new e.Symbol(t.$symbol)}function T(e){return{$timestamp:{t:e.high_,i:e.low_}}}function I(e,t){return new e.Timestamp(t.$timestamp.i,t.$timestamp.t)}function R(e){Z.forEach(function(t){if(!e[t])throw new Error("passed in module does not contain all BSON types required")}),q=e}function D(e,t,r,n){if("number"==typeof r){if(Math.floor(r)===r){var i=r>=re&&r<=te,o=r>=ie&&r<=ne;if(i)return n.strict?new q.Int32(r):r;if(o)return n.strict?new q.Long.fromNumber(r):r}return new q.Double(r)}if(null==r||"object"!==(void 0===r?"undefined":G(r)))return r;if(r.$undefined)return null;for(var u=Object.keys(r).filter(function(e){return e.startsWith("$")&&null!=r[e]}),s=0;s<u.length;s++){var a=Q[u[s]];if(a)return a.fromExtendedJSON(q,r,n)}if(null!=r.$date){var f=r.$date,c=new Date;return"string"==typeof f?c.setTime(Date.parse(f)):f instanceof q.Long?c.setTime(f.toNumber()):"number"==typeof f&&n.relaxed&&c.setTime(f),c}if(null!=r.$code){if(r.$scope)var l=D(e,null,r.$scope);return Object.assign({},r).$scope=l,H.Code.fromExtendedJSON(q,r)}if(null!=r.$ref||null!=r.$dbPointer){var h=r.$ref?r:r.$dbPointer;if(h instanceof q.DBRef)return h;var p=Object.keys(h).filter(function(e){return e.startsWith("$")}),d=!0;if(p.forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(d=!1)}),d)return H.DBRef.fromExtendedJSON(q,h)}return r}function P(e,t){return e.map(function(e){return $(e,t)})}function L(e){var t=e.toISOString();return 0!==e.getUTCMilliseconds()?t:t.slice(0,-5)+"Z"}function $(e,t){if(Array.isArray(e))return P(e,t);if(void 0===e)return null;if(e instanceof Date){var r=e.getTime(),n=r>-1&&r<2534023188e5;return t.relaxed&&n?{$date:L(e)}:{$date:{$numberLong:e.getTime().toString()}}}if("number"==typeof e&&!t.relaxed){if(Math.floor(e)===e){var i=e>=re&&e<=te,o=e>=ie&&e<=ne;if(i)return{$numberInt:e.toString()};if(o)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}return null!=e&&"object"===(void 0===e?"undefined":G(e))?k(e,t):e}function k(e,t){if(null==e||"object"!==(void 0===e?"undefined":G(e)))throw new Error("not an object instance");if(e._bsontype&&-1!==Z.indexOf(e._bsontype)){if("Code"===e._bsontype&&e.scope){var r=k(e.scope,t),n=Object.assign({},e,{scope:r});return H.Code.toExtendedJSON(n,t)}if("DBRef"===e._bsontype&&e.oid){var i=k(e.oid,t),o=Object.assign({},e,{oid:i});return H.DBRef.toExtendedJSON(o,t)}return H[e._bsontype].toExtendedJSON(e,t)}var u={};for(var s in e){var a=e[s];if(Array.isArray(a))u[s]=P(a,t);else if(null!=a&&a._bsontype&&-1!==Z.indexOf(a._bsontype))if("Code"===a._bsontype&&a.scope){var f=k(a.scope,t),c=Object.assign({},a,{scope:f});u[s]=H.Code.toExtendedJSON(c,t)}else if("DBRef"===a._bsontype&&a.oid){var l=k(a.oid,t),h=Object.assign({},a,{oid:l});u[s]=H.DBRef.toExtendedJSON(h,t)}else u[s]=H[a._bsontype].toExtendedJSON(a,t);else a instanceof Date?u[s]=$(a,t):null!=a&&"object"===(void 0===a?"undefined":G(a))&&(u[s]=k(a,t));if(u[s]=$(a,t),a instanceof RegExp){var p=a.flags;void 0===p&&(p=a.toString().match(/[gimuy]*$/)[0]),u[s]=H.BSONRegExp.toExtendedJSON({pattern:a.source,options:p})}}return u}e=e&&e.hasOwnProperty("default")?e.default:e;var U={toExtendedJSON:r,fromExtendedJSON:i},x={toExtendedJSON:o,fromExtendedJSON:u},M={toExtendedJSON:a,fromExtendedJSON:f},j={toExtendedJSON:c,fromExtendedJSON:l},C={toExtendedJSON:h,fromExtendedJSON:p},Y={toExtendedJSON:d,fromExtendedJSON:g},F={toExtendedJSON:_,fromExtendedJSON:y},z={toExtendedJSON:b,fromExtendedJSON:v},K={toExtendedJSON:m,fromExtendedJSON:B},W={toExtendedJSON:S,fromExtendedJSON:E},J={toExtendedJSON:O,fromExtendedJSON:w},V={toExtendedJSON:N,fromExtendedJSON:A},X={toExtendedJSON:T,fromExtendedJSON:I},H={Binary:U,Code:x,DBRef:M,Decimal128:j,Double:C,Int32:Y,Long:F,MaxKey:z,MinKey:K,ObjectID:W,BSONRegExp:J,Symbol:V,Timestamp:X},G="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},q=e,Z=["Binary","Code","DBRef","Decimal128","Double","Int32","Long","MaxKey","MinKey","ObjectID","BSONRegExp","Symbol","Timestamp"];R(q);var Q={$oid:H.ObjectID,$binary:H.Binary,$symbol:H.Symbol,$numberInt:H.Int32,$numberDecimal:H.Decimal128,$numberDouble:H.Double,$numberLong:H.Long,$minKey:H.MinKey,$maxKey:H.MaxKey,$regularExpression:H.BSONRegExp,$timestamp:H.Timestamp},ee=function(e,t){var r=this;return t=t||{relaxed:!1},"boolean"==typeof t.relaxed&&(t.strict=!t.relaxed),"boolean"==typeof t.strict&&(t.relaxed=!t.strict),JSON.parse(e,function(e,n){return D(r,e,n,t)})},te=2147483647,re=-2147483648,ne=0x8000000000000000,ie=-0x8000000000000000;return{parse:ee,stringify:function(e,t,r,n){var i={};null!=n&&"object"===(void 0===n?"undefined":G(n))?i=n:null!=r&&"object"===(void 0===r?"undefined":G(r))?(i=r,r=0):null!=t&&"object"===(void 0===t?"undefined":G(t))&&(i=t,t=null);var o=Array.isArray(e)?P(e,i):k(e,i);return JSON.stringify(o,t,r)},setBSONModule:R,BSON:q}})}).call(t,r(8).Buffer)},function(module,exports,__webpack_require__){"use strict";(function(global,Buffer,process){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__,_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"===_typeof2(exports)&&void 0!==module?module.exports=t():(__WEBPACK_AMD_DEFINE_FACTORY__=t,void 0!==(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__)&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(0,function(){function createCommonjsModule(e,t){return t={exports:{}},e(t,t.exports),t.exports}function Long(e,t){if(!(this instanceof Long))return new Long(e,t);this._bsontype="Long",this.low_=0|e,this.high_=0|t}function Double(e){if(!(this instanceof Double))return new Double(e);this._bsontype="Double",this.value=e}function Timestamp(e,t){e instanceof long_1?long_1.call(this,e.low_,e.high_):long_1.call(this,e,t),this._bsontype="Timestamp"}function endianness(){if(void 0===_endianness){var e=new ArrayBuffer(2),t=new Uint8Array(e),r=new Uint16Array(e);if(t[0]=1,t[1]=2,258===r[0])_endianness="BE";else{if(513!==r[0])throw new Error("unable to figure out endianess");_endianness="LE"}}return _endianness}function hostname(){return void 0!==global.location?global.location.hostname:""}function loadavg(){return[]}function uptime(){return 0}function freemem(){return Number.MAX_VALUE}function totalmem(){return Number.MAX_VALUE}function cpus(){return[]}function type(){return"Browser"}function release(){return void 0!==global.navigator?global.navigator.appVersion:""}function networkInterfaces(){}function getNetworkInterfaces(){}function arch(){return"javascript"}function platform(){return"browser"}function tmpDir(){return"/tmp"}function fnv1a32(e,t){t=t||"utf8";for(var r=Buffer.from(e,t),n=OFFSET_BASIS,i=0;i<r.length;i+=1)n=n.xor(new long_1(r[i],0)),n=n.multiply(FNV_PRIME),n=n.and(FNV_MASK);return n.getLowBitsUnsigned()}function fnv1a24(e,t){var r=fnv1a32(e,t);return(r&MASK_24^r>>>24&MASK_8)&MASK_24}function ObjectID(e){if(e instanceof ObjectID)return e;if(!(this instanceof ObjectID))return new ObjectID(e);if(this._bsontype="ObjectID",null==e||"number"==typeof e)return this.id=this.generate(e),void(ObjectID.cacheHexString&&(this.__id=this.toString("hex")));var t=ObjectID.isValid(e);if(!t&&null!=e)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(t&&"string"==typeof e&&24===e.length&&hasBufferType)return new ObjectID(new Buffer(e,"hex"));if(t&&"string"==typeof e&&24===e.length)return ObjectID.createFromHexString(e);if(null==e||12!==e.length){if(null!=e&&e.toHexString)return e;throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}this.id=e,ObjectID.cacheHexString&&(this.__id=this.toString("hex"))}function alphabetize(e){return e.split("").sort().join("")}function BSONRegExp(e,t){if(!(this instanceof BSONRegExp))return new BSONRegExp(e,t);this._bsontype="BSONRegExp",this.pattern=e||"",this.options=t?alphabetize(t):"";for(var r=0;r<this.options.length;r++)if("i"!==this.options[r]&&"m"!==this.options[r]&&"x"!==this.options[r]&&"l"!==this.options[r]&&"s"!==this.options[r]&&"u"!==this.options[r])throw new Error("the regular expression options ["+this.options[r]+"] is not supported")}function _Symbol(e){if(!(this instanceof _Symbol))return new _Symbol(e);this._bsontype="Symbol",this.value=e}function Int32(e){if(!(this instanceof Int32))return new Int32(e);this._bsontype="Int32",this.value=e}function Code(e,t){if(!(this instanceof Code))return new Code(e,t);this._bsontype="Code",this.code=e,this.scope=t}function Decimal128(e){this._bsontype="Decimal128",this.bytes=e}function MinKey(){if(!(this instanceof MinKey))return new MinKey;this._bsontype="MinKey"}function MaxKey(){if(!(this instanceof MaxKey))return new MaxKey;this._bsontype="MaxKey"}function DBRef(e,t,r,n){if(!(this instanceof DBRef))return new DBRef(e,t,r,n);var i=e.split(".");2===i.length&&(r=i.shift(),e=i.shift()),this._bsontype="DBRef",this.collection=e,this.oid=t,this.db=r,this.fields=n||{}}function init(){inited=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)lookup[t]=e[t],revLookup[e.charCodeAt(t)]=t;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63}function toByteArray(e){inited||init();var t,r,n,i,o,u,s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[s-2]?2:"="===e[s-1]?1:0,u=new Arr(3*s/4-o),n=o>0?s-4:s;var a=0;for(t=0,r=0;t<n;t+=4,r+=3)i=revLookup[e.charCodeAt(t)]<<18|revLookup[e.charCodeAt(t+1)]<<12|revLookup[e.charCodeAt(t+2)]<<6|revLookup[e.charCodeAt(t+3)],u[a++]=i>>16&255,u[a++]=i>>8&255,u[a++]=255&i;return 2===o?(i=revLookup[e.charCodeAt(t)]<<2|revLookup[e.charCodeAt(t+1)]>>4,u[a++]=255&i):1===o&&(i=revLookup[e.charCodeAt(t)]<<10|revLookup[e.charCodeAt(t+1)]<<4|revLookup[e.charCodeAt(t+2)]>>2,u[a++]=i>>8&255,u[a++]=255&i),u}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(tripletToBase64(n));return i.join("")}function fromByteArray(e){inited||init();for(var t,r=e.length,n=r%3,i="",o=[],u=0,s=r-n;u<s;u+=16383)o.push(encodeChunk(e,u,u+16383>s?s:u+16383));return 1===n?(t=e[r-1],i+=lookup[t>>2],i+=lookup[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=lookup[t>>10],i+=lookup[t>>4&63],i+=lookup[t<<2&63],i+="="),o.push(i),o.join("")}function read(e,t,r,n,i){var o,u,s=8*i-n-1,a=(1<<s)-1,f=a>>1,c=-7,l=r?i-1:0,h=r?-1:1,p=e[t+l];for(l+=h,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+e[t+l],l+=h,c-=8);for(u=o&(1<<-c)-1,o>>=-c,c+=n;c>0;u=256*u+e[t+l],l+=h,c-=8);if(0===o)o=1-f;else{if(o===a)return u?NaN:1/0*(p?-1:1);u+=Math.pow(2,n),o-=f}return(p?-1:1)*u*Math.pow(2,o-n)}function write(e,t,r,n,i,o){var u,s,a,f=8*o-i-1,c=(1<<f)-1,l=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,u=c):(u=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-u))<1&&(u--,a*=2),t+=u+l>=1?h/a:h*Math.pow(2,1-l),t*a>=2&&(u++,a/=2),u+l>=c?(s=0,u=c):u+l>=1?(s=(t*a-1)*Math.pow(2,i),u+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,i),u=0));i>=8;e[r+p]=255&s,p+=d,s/=256,i-=8);for(u=u<<i|s,f+=i;f>0;e[r+p]=255&u,p+=d,u/=256,f-=8);e[r+p-d]|=128*g}function kMaxLength(){return Buffer$1.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(e,t){if(kMaxLength()<t)throw new RangeError("Invalid typed array length");return Buffer$1.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=Buffer$1.prototype):(null===e&&(e=new Buffer$1(t)),e.length=t),e}function Buffer$1(e,t,r){if(!(Buffer$1.TYPED_ARRAY_SUPPORT||this instanceof Buffer$1))return new Buffer$1(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,e)}return from(this,e,t,r)}function from(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?fromArrayBuffer(e,t,r,n):"string"==typeof t?fromString(e,t,r):fromObject(e,t)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function alloc(e,t,r,n){return assertSize(t),t<=0?createBuffer(e,t):void 0!==r?"string"==typeof n?createBuffer(e,t).fill(r,n):createBuffer(e,t).fill(r):createBuffer(e,t)}function allocUnsafe(e,t){if(assertSize(t),e=createBuffer(e,t<0?0:0|checked(t)),!Buffer$1.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function fromString(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!Buffer$1.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength(t,r);e=createBuffer(e,n);var i=e.write(t,r);return i!==n&&(e=e.slice(0,i)),e}function fromArrayLike(e,t){var r=t.length<0?0:0|checked(t.length);e=createBuffer(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function fromArrayBuffer(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),Buffer$1.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=Buffer$1.prototype):e=fromArrayLike(e,t),e}function fromObject(e,t){if(internalIsBuffer(t)){var r=0|checked(t.length);return e=createBuffer(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||isnan(t.length)?createBuffer(e,0):fromArrayLike(e,t);if("Buffer"===t.type&&isArray(t.data))return fromArrayLike(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(e){if(e>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer$1.alloc(+e)}function internalIsBuffer(e){return!(null==e||!e._isBuffer)}function byteLength(e,t){if(internalIsBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(n)return utf8ToBytes(e).length;t=(""+t).toLowerCase(),n=!0}}function slowToString(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function swap(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function bidirectionalIndexOf(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=Buffer$1.from(t,n)),internalIsBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,n,i);if("number"==typeof t)return t&=255,Buffer$1.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,n,i){function o(e,t){return 1===u?e[t]:e.readUInt16BE(t*u)}var u=1,s=e.length,a=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;u=2,s/=2,a/=2,r/=2}var f;if(i){var c=-1;for(f=r;f<s;f++)if(o(e,f)===o(t,-1===c?0:f-c)){if(-1===c&&(c=f),f-c+1===a)return c*u}else-1!==c&&(f-=f-c),c=-1}else for(r+a>s&&(r=s-a),f=r;f>=0;f--){for(var l=!0,h=0;h<a;h++)if(o(e,f+h)!==o(t,h)){l=!1;break}if(l)return f}return-1}function hexWrite(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var s=parseInt(t.substr(2*u,2),16);if(isNaN(s))return u;e[r+u]=s}return u}function utf8Write(e,t,r,n){return blitBuffer(utf8ToBytes(t,e.length-r),e,r,n)}function asciiWrite(e,t,r,n){return blitBuffer(asciiToBytes(t),e,r,n)}function latin1Write(e,t,r,n){return asciiWrite(e,t,r,n)}function base64Write(e,t,r,n){return blitBuffer(base64ToBytes(t),e,r,n)}function ucs2Write(e,t,r,n){return blitBuffer(utf16leToBytes(t,e.length-r),e,r,n)}function base64Slice(e,t,r){return fromByteArray(0===t&&r===e.length?e:e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],u=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var a,f,c,l;switch(s){case 1:o<128&&(u=o);break;case 2:a=e[i+1],128==(192&a)&&(l=(31&o)<<6|63&a)>127&&(u=l);break;case 3:a=e[i+1],f=e[i+2],128==(192&a)&&128==(192&f)&&(l=(15&o)<<12|(63&a)<<6|63&f)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:a=e[i+1],f=e[i+2],c=e[i+3],128==(192&a)&&128==(192&f)&&128==(192&c)&&(l=(15&o)<<18|(63&a)<<12|(63&f)<<6|63&c)>65535&&l<1114112&&(u=l)}}null===u?(u=65533,s=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=s}return decodeCodePointsArray(n)}function decodeCodePointsArray(e){var t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function latin1Slice(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function hexSlice(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=toHex(e[o]);return i}function utf16leSlice(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,n,i,o){if(!internalIsBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function objectWriteUInt16(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function objectWriteUInt32(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function checkIEEE754(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,n,i){return i||checkIEEE754(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),write(e,t,r,n,23,4),r+4}function writeDouble(e,t,r,n,i){return i||checkIEEE754(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),write(e,t,r,n,52,8),r+8}function base64clean(e){if(e=stringtrim(e).replace(INVALID_BASE64_RE,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function stringtrim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],u=0;u<n;++u){if((r=e.charCodeAt(u))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function asciiToBytes(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function utf16leToBytes(e,t){for(var r,n,i,o=[],u=0;u<e.length&&!((t-=2)<0);++u)r=e.charCodeAt(u),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function base64ToBytes(e){return toByteArray(base64clean(e))}function blitBuffer(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function isnan(e){return e!==e}function isBuffer(e){return null!=e&&(!!e._isBuffer||isFastBuffer(e)||isSlowBuffer(e))}function isFastBuffer(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&isFastBuffer(e.slice(0,0))}function Binary(e,t){if(!(this instanceof Binary))return new Binary(e,t);if(!(null==e||"string"==typeof e||Buffer$2.isBuffer(e)||e instanceof Uint8Array||Array.isArray(e)))throw new Error("only String, Buffer, Uint8Array or Array accepted");if(this._bsontype="Binary",e instanceof Number?(this.sub_type=e,this.position=0):(this.sub_type=null==t?BSON_BINARY_SUBTYPE_DEFAULT:t,this.position=0),null==e||e instanceof Number)void 0!==Buffer$2?this.buffer=new Buffer$2(Binary.BUFFER_SIZE):"undefined"!=typeof Uint8Array?this.buffer=new Uint8Array(new ArrayBuffer(Binary.BUFFER_SIZE)):this.buffer=new Array(Binary.BUFFER_SIZE),this.position=0;else{if("string"==typeof e)if(void 0!==Buffer$2)this.buffer=new Buffer$2(e);else{if("undefined"==typeof Uint8Array&&"[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("only String, Buffer, Uint8Array or Array accepted");this.buffer=writeStringToArray(e)}else this.buffer=e;this.position=e.length}}function normalizedFunctionString(e){return e.toString().replace("function(","function (")}function calculateElement(e,t,r,n,i){switch(t&&t.toBSON&&(t=t.toBSON()),void 0===t?"undefined":_typeof(t)){case"string":return 1+Buffer.byteLength(e,"utf8")+1+4+Buffer.byteLength(t,"utf8")+1;case"number":return Math.floor(t)===t&&t>=BSON$2.JS_INT_MIN&&t<=BSON$2.JS_INT_MAX&&t>=BSON$2.BSON_INT32_MIN&&t<=BSON$2.BSON_INT32_MAX?(null!=e?Buffer.byteLength(e,"utf8")+1:0)+5:(null!=e?Buffer.byteLength(e,"utf8")+1:0)+9;case"undefined":return n||!i?(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1:0;case"boolean":return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+2;case"object":if(null==t||t instanceof MinKey$3||t instanceof MaxKey$2||"MinKey"===t._bsontype||"MaxKey"===t._bsontype)return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1;if(t instanceof ObjectID$2||"ObjectID"===t._bsontype)return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+13;if(t instanceof Date||isDate$1(t))return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+9;if(void 0!==Buffer&&Buffer.isBuffer(t))return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+6+t.length;if(t instanceof Long$3||t instanceof Double$2||t instanceof Timestamp$2||"Long"===t._bsontype||"Double"===t._bsontype||"Timestamp"===t._bsontype)return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+9;if(t instanceof decimal128||"Decimal128"===t._bsontype)return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+17;if(t instanceof Code$2||"Code"===t._bsontype)return null!=t.scope&&Object.keys(t.scope).length>0?(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1+4+4+Buffer.byteLength(t.code.toString(),"utf8")+1+calculateObjectSize(t.scope,r,i):(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1+4+Buffer.byteLength(t.code.toString(),"utf8")+1;if(t instanceof Binary$3||"Binary"===t._bsontype)return t.sub_type===Binary$3.SUBTYPE_BYTE_ARRAY?(null!=e?Buffer.byteLength(e,"utf8")+1:0)+(t.position+1+4+1+4):(null!=e?Buffer.byteLength(e,"utf8")+1:0)+(t.position+1+4+1);if(t instanceof _Symbol$1||"Symbol"===t._bsontype)return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+Buffer.byteLength(t.value,"utf8")+4+1+1;if(t instanceof DBRef$2||"DBRef"===t._bsontype){var o={$ref:t.collection,$id:t.oid};return null!=t.db&&(o.$db=t.db),o=Object.assign(o,t.fields),(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1+calculateObjectSize(o,r,i)}return t instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(t)?(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1+Buffer.byteLength(t.source,"utf8")+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1:t instanceof BSONRegExp$2||"BSONRegExp"===t._bsontype?(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1+Buffer.byteLength(t.pattern,"utf8")+1+Buffer.byteLength(t.options,"utf8")+1:(null!=e?Buffer.byteLength(e,"utf8")+1:0)+calculateObjectSize(t,r,i)+1;case"function":if(t instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(t)||"[object RegExp]"===String.call(t))return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1+Buffer.byteLength(t.source,"utf8")+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1;if(r&&null!=t.scope&&Object.keys(t.scope).length>0)return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1+4+4+Buffer.byteLength(normalizedFunctionString$2(t),"utf8")+1+calculateObjectSize(t.scope,r,i);if(r)return(null!=e?Buffer.byteLength(e,"utf8")+1:0)+1+4+Buffer.byteLength(normalizedFunctionString$2(t),"utf8")+1}return 0}var commonjsGlobal="undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{},map=createCommonjsModule(function(e){if(void 0!==commonjsGlobal.Map)e.exports=commonjsGlobal.Map,e.exports.Map=commonjsGlobal.Map;else{var t=function(e){this._keys=[],this._values={};for(var t=0;t<e.length;t++)if(null!=e[t]){var r=e[t],n=r[0],i=r[1];this._keys.push(n),this._values[n]={v:i,i:this._keys.length-1}}};t.prototype.clear=function(){this._keys=[],this._values={}},t.prototype.delete=function(e){var t=this._values[e];return null!=t&&(delete this._values[e],this._keys.splice(t.i,1),!0)},t.prototype.entries=function(){var e=this,t=0;return{next:function(){var r=e._keys[t++];return{value:void 0!==r?[r,e._values[r].v]:void 0,done:void 0===r}}}},t.prototype.forEach=function(e,t){t=t||this;for(var r=0;r<this._keys.length;r++){var n=this._keys[r];e.call(t,this._values[n].v,n,t)}},t.prototype.get=function(e){return this._values[e]?this._values[e].v:void 0},t.prototype.has=function(e){return null!=this._values[e]},t.prototype.keys=function(){var e=this,t=0;return{next:function(){var r=e._keys[t++];return{value:void 0!==r?r:void 0,done:void 0===r}}}},t.prototype.set=function(e,t){return this._values[e]?(this._values[e].v=t,this):(this._keys.push(e),this._values[e]={v:t,i:this._keys.length-1},this)},t.prototype.values=function(){var e=this,t=0;return{next:function(){var r=e._keys[t++];return{value:void 0!==r?e._values[r].v:void 0,done:void 0===r}}}},Object.defineProperty(t.prototype,"size",{enumerable:!0,get:function(){return this._keys.length}}),e.exports=t,e.exports.Map=t}}),map_1=map.Map;Long.prototype.toInt=function(){return this.low_},Long.prototype.toNumber=function(){return this.high_*Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},Long.prototype.toJSON=function(){return this.toString()},Long.prototype.toString=function(e){var t=e||10;if(t<2||36<t)throw Error("radix out of range: "+t);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(Long.MIN_VALUE)){var r=Long.fromNumber(t),n=this.div(r),i=n.multiply(r).subtract(this);return n.toString(t)+i.toInt().toString(t)}return"-"+this.negate().toString(t)}var o=Long.fromNumber(Math.pow(t,6));i=this;for(var u="";!i.isZero();){var s=i.div(o),a=i.subtract(s.multiply(o)).toInt(),f=a.toString(t);if(i=s,i.isZero())return f+u;for(;f.length<6;)f="0"+f;u=""+f+u}},Long.prototype.getHighBits=function(){return this.high_},Long.prototype.getLowBits=function(){return this.low_},Long.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:Long.TWO_PWR_32_DBL_+this.low_},Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!==this.high_?this.high_:this.low_,t=31;t>0&&0==(e&1<<t);t--);return 0!==this.high_?t+33:t+1},Long.prototype.isZero=function(){return 0===this.high_&&0===this.low_},Long.prototype.isNegative=function(){return this.high_<0},Long.prototype.isOdd=function(){return 1==(1&this.low_)},Long.prototype.equals=function(e){return this.high_===e.high_&&this.low_===e.low_},Long.prototype.notEquals=function(e){return this.high_!==e.high_||this.low_!==e.low_},Long.prototype.lessThan=function(e){return this.compare(e)<0},Long.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},Long.prototype.greaterThan=function(e){return this.compare(e)>0},Long.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},Long.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.subtract(e).isNegative()?-1:1},Long.prototype.negate=function(){return this.equals(Long.MIN_VALUE)?Long.MIN_VALUE:this.not().add(Long.ONE)},Long.prototype.add=function(e){var t=this.high_>>>16,r=65535&this.high_,n=this.low_>>>16,i=65535&this.low_,o=e.high_>>>16,u=65535&e.high_,s=e.low_>>>16,a=65535&e.low_,f=0,c=0,l=0,h=0;return h+=i+a,l+=h>>>16,h&=65535,l+=n+s,c+=l>>>16,l&=65535,c+=r+u,f+=c>>>16,c&=65535,f+=t+o,f&=65535,Long.fromBits(l<<16|h,f<<16|c)},Long.prototype.subtract=function(e){return this.add(e.negate())},Long.prototype.multiply=function(e){if(this.isZero())return Long.ZERO;if(e.isZero())return Long.ZERO;if(this.equals(Long.MIN_VALUE))return e.isOdd()?Long.MIN_VALUE:Long.ZERO;if(e.equals(Long.MIN_VALUE))return this.isOdd()?Long.MIN_VALUE:Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(Long.TWO_PWR_24_)&&e.lessThan(Long.TWO_PWR_24_))return Long.fromNumber(this.toNumber()*e.toNumber());var t=this.high_>>>16,r=65535&this.high_,n=this.low_>>>16,i=65535&this.low_,o=e.high_>>>16,u=65535&e.high_,s=e.low_>>>16,a=65535&e.low_,f=0,c=0,l=0,h=0;return h+=i*a,l+=h>>>16,h&=65535,l+=n*a,c+=l>>>16,l&=65535,l+=i*s,c+=l>>>16,l&=65535,c+=r*a,f+=c>>>16,c&=65535,c+=n*s,f+=c>>>16,c&=65535,c+=i*u,f+=c>>>16,c&=65535,f+=t*a+r*s+n*u+i*o,f&=65535,Long.fromBits(l<<16|h,f<<16|c)},Long.prototype.div=function(e){if(e.isZero())throw Error("division by zero");if(this.isZero())return Long.ZERO;if(this.equals(Long.MIN_VALUE)){if(e.equals(Long.ONE)||e.equals(Long.NEG_ONE))return Long.MIN_VALUE;if(e.equals(Long.MIN_VALUE))return Long.ONE;var t=this.shiftRight(1),r=t.div(e).shiftLeft(1);if(r.equals(Long.ZERO))return e.isNegative()?Long.ONE:Long.NEG_ONE;var n=this.subtract(e.multiply(r));return r.add(n.div(e))}if(e.equals(Long.MIN_VALUE))return Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();var i=Long.ZERO;for(n=this;n.greaterThanOrEqual(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),u=o<=48?1:Math.pow(2,o-48),s=Long.fromNumber(r),a=s.multiply(e);a.isNegative()||a.greaterThan(n);)r-=u,s=Long.fromNumber(r),a=s.multiply(e);s.isZero()&&(s=Long.ONE),i=i.add(s),n=n.subtract(a)}return i},Long.prototype.modulo=function(e){return this.subtract(this.div(e).multiply(e))},Long.prototype.not=function(){return Long.fromBits(~this.low_,~this.high_)},Long.prototype.and=function(e){return Long.fromBits(this.low_&e.low_,this.high_&e.high_)},Long.prototype.or=function(e){return Long.fromBits(this.low_|e.low_,this.high_|e.high_)},Long.prototype.xor=function(e){return Long.fromBits(this.low_^e.low_,this.high_^e.high_)},Long.prototype.shiftLeft=function(e){if(0===(e&=63))return this;var t=this.low_;if(e<32){var r=this.high_;return Long.fromBits(t<<e,r<<e|t>>>32-e)}return Long.fromBits(0,t<<e-32)},Long.prototype.shiftRight=function(e){if(0===(e&=63))return this;var t=this.high_;if(e<32){var r=this.low_;return Long.fromBits(r>>>e|t<<32-e,t>>e)}return Long.fromBits(t>>e-32,t>=0?0:-1)},Long.prototype.shiftRightUnsigned=function(e){if(0===(e&=63))return this;var t=this.high_;if(e<32){var r=this.low_;return Long.fromBits(r>>>e|t<<32-e,t>>>e)}return 32===e?Long.fromBits(t,0):Long.fromBits(t>>>e-32,0)},Long.fromInt=function(e){if(-128<=e&&e<128){var t=Long.INT_CACHE_[e];if(t)return t}var r=new Long(0|e,e<0?-1:0);return-128<=e&&e<128&&(Long.INT_CACHE_[e]=r),r},Long.fromNumber=function(e){return isNaN(e)||!isFinite(e)?Long.ZERO:e<=-Long.TWO_PWR_63_DBL_?Long.MIN_VALUE:e+1>=Long.TWO_PWR_63_DBL_?Long.MAX_VALUE:e<0?Long.fromNumber(-e).negate():new Long(e%Long.TWO_PWR_32_DBL_|0,e/Long.TWO_PWR_32_DBL_|0)},Long.fromBits=function(e,t){return new Long(e,t)},Long.fromString=function(e,t){if(0===e.length)throw Error("number format error: empty string");var r=t||10;if(r<2||36<r)throw Error("radix out of range: "+r);if("-"===e.charAt(0))return Long.fromString(e.substring(1),r).negate();if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+e);for(var n=Long.fromNumber(Math.pow(r,8)),i=Long.ZERO,o=0;o<e.length;o+=8){var u=Math.min(8,e.length-o),s=parseInt(e.substring(o,o+u),r);if(u<8){var a=Long.fromNumber(Math.pow(r,u));i=i.multiply(a).add(Long.fromNumber(s))}else i=i.multiply(n),i=i.add(Long.fromNumber(s))}return i},Long.INT_CACHE_={},Long.TWO_PWR_16_DBL_=65536,Long.TWO_PWR_24_DBL_=1<<24,Long.TWO_PWR_32_DBL_=Long.TWO_PWR_16_DBL_*Long.TWO_PWR_16_DBL_,Long.TWO_PWR_31_DBL_=Long.TWO_PWR_32_DBL_/2,Long.TWO_PWR_48_DBL_=Long.TWO_PWR_32_DBL_*Long.TWO_PWR_16_DBL_,Long.TWO_PWR_64_DBL_=Long.TWO_PWR_32_DBL_*Long.TWO_PWR_32_DBL_,Long.TWO_PWR_63_DBL_=Long.TWO_PWR_64_DBL_/2,Long.ZERO=Long.fromInt(0),Long.ONE=Long.fromInt(1),Long.NEG_ONE=Long.fromInt(-1),Long.MAX_VALUE=Long.fromBits(-1,2147483647),Long.MIN_VALUE=Long.fromBits(0,-2147483648),Long.TWO_PWR_24_=Long.fromInt(1<<24);var long_1=Long,Long_1=Long;long_1.Long=Long_1,Double.prototype.valueOf=function(){return this.value},Double.prototype.toJSON=function(){return this.value};var double_1=Double,Double_1=Double;double_1.Double=Double_1,Timestamp.prototype=Object.create(long_1.prototype),Timestamp.prototype.constructor=Timestamp,Timestamp.prototype.toJSON=function(){return{$timestamp:this.toString()}},Timestamp.fromInt=function(e){return new Timestamp(long_1.fromInt(e))},Timestamp.fromNumber=function(e){return new Timestamp(long_1.fromNumber(e))},Timestamp.fromBits=function(e,t){return new Timestamp(e,t)},Timestamp.fromString=function(e,t){return new Timestamp(long_1.fromString(e,t))};var timestamp=Timestamp,Timestamp_1=Timestamp;timestamp.Timestamp=Timestamp_1;var _endianness,tmpdir=tmpDir,EOL="\n",os={EOL:EOL,tmpdir:tmpdir,tmpDir:tmpDir,networkInterfaces:networkInterfaces,getNetworkInterfaces:getNetworkInterfaces,release:release,type:type,cpus:cpus,totalmem:totalmem,freemem:freemem,uptime:uptime,loadavg:loadavg,hostname:hostname,endianness:endianness},os$1=Object.freeze({endianness:endianness,hostname:hostname,loadavg:loadavg,uptime:uptime,freemem:freemem,totalmem:totalmem,cpus:cpus,type:type,release:release,networkInterfaces:networkInterfaces,getNetworkInterfaces:getNetworkInterfaces,arch:arch,platform:platform,tmpDir:tmpDir,tmpdir:tmpdir,EOL:EOL,default:os}),MASK_8=255,MASK_24=16777215,MASK_32=4294967295,FNV_PRIME=new long_1(16777619,0),OFFSET_BASIS=new long_1(2166136261,0),FNV_MASK=new long_1(MASK_32,0),fnv1a={fnv1a24:fnv1a24,fnv1a32:fnv1a32},require$$0=os$1&&os||os$1,hostname$1=require$$0.hostname,fnv1a24$1=fnv1a.fnv1a24,MACHINE_ID=fnv1a24$1(hostname$1),checkForHexRegExp=new RegExp("^[0-9a-fA-F]{24}$"),hasBufferType=!1;try{Buffer&&Buffer.from&&(hasBufferType=!0)}catch(e){hasBufferType=!1}for(var hexTable=[],i=0;i<256;i++)hexTable[i]=(i<=15?"0":"")+i.toString(16);ObjectID.prototype.toHexString=function(){if(ObjectID.cacheHexString&&this.__id)return this.__id;var e="";if(!this.id||!this.id.length)throw new TypeError("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]");if(this.id instanceof _Buffer)return e=convertToHex(this.id),ObjectID.cacheHexString&&(this.__id=e),e;for(var t=0;t<this.id.length;t++)e+=hexTable[this.id.charCodeAt(t)];return ObjectID.cacheHexString&&(this.__id=e),e},ObjectID.prototype.get_inc=function(){return ObjectID.index=(ObjectID.index+1)%16777215},ObjectID.prototype.getInc=function(){return this.get_inc()},ObjectID.prototype.generate=function(e){"number"!=typeof e&&(e=~~(Date.now()/1e3));var t=(void 0===process||1===process.pid?Math.floor(1e5*Math.random()):process.pid)%65535,r=this.get_inc(),n=new Buffer(12);return n[3]=255&e,n[2]=e>>8&255,n[1]=e>>16&255,n[0]=e>>24&255,n[6]=255&MACHINE_ID,n[5]=MACHINE_ID>>8&255,n[4]=MACHINE_ID>>16&255,n[8]=255&t,n[7]=t>>8&255,n[11]=255&r,n[10]=r>>8&255,n[9]=r>>16&255,n},ObjectID.prototype.toString=function(e){return this.id&&this.id.copy?this.id.toString("string"==typeof e?e:"hex"):this.toHexString()},ObjectID.prototype.inspect=ObjectID.prototype.toString,ObjectID.prototype.toJSON=function(){return this.toHexString()},ObjectID.prototype.equals=function(e){return e instanceof ObjectID?this.toString()===e.toString():"string"==typeof e&&ObjectID.isValid(e)&&12===e.length&&this.id instanceof _Buffer?e===this.id.toString("binary"):"string"==typeof e&&ObjectID.isValid(e)&&24===e.length?e.toLowerCase()===this.toHexString():"string"==typeof e&&ObjectID.isValid(e)&&12===e.length?e===this.id:!(null==e||!(e instanceof ObjectID||e.toHexString))&&e.toHexString()===this.toHexString()},ObjectID.prototype.getTimestamp=function(){var e=new Date,t=this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24;return e.setTime(1e3*Math.floor(t)),e},ObjectID.index=~~(16777215*Math.random()),ObjectID.createPk=function(){return new ObjectID},ObjectID.createFromTime=function(e){var t=new Buffer([0,0,0,0,0,0,0,0,0,0,0,0]);return t[3]=255&e,t[2]=e>>8&255,t[1]=e>>16&255,t[0]=e>>24&255,new ObjectID(t)};var decodeLookup=[];for(i=0;i<10;)decodeLookup[48+i]=i++;for(;i<16;)decodeLookup[55+i]=decodeLookup[87+i]=i++;var _Buffer=Buffer,convertToHex=function(e){return e.toString("hex")};ObjectID.createFromHexString=function(e){if(void 0===e||null!=e&&24!==e.length)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(hasBufferType)return new ObjectID(new Buffer(e,"hex"));for(var t=new _Buffer(12),r=0,n=0;n<24;)t[r++]=decodeLookup[e.charCodeAt(n++)]<<4|decodeLookup[e.charCodeAt(n++)];return new ObjectID(t)},ObjectID.isValid=function(e){return null!=e&&("number"==typeof e||("string"==typeof e?12===e.length||24===e.length&&checkForHexRegExp.test(e):e instanceof ObjectID||(e instanceof _Buffer||!!e.toHexString&&(12===e.id.length||24===e.id.length&&checkForHexRegExp.test(e.id)))))},Object.defineProperty(ObjectID.prototype,"generationTime",{enumerable:!0,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(e){this.id[3]=255&e,this.id[2]=e>>8&255,this.id[1]=e>>16&255,this.id[0]=e>>24&255}});var objectid=ObjectID,ObjectID_1=ObjectID,ObjectId=ObjectID;objectid.ObjectID=ObjectID_1,objectid.ObjectId=ObjectId;var regexp=BSONRegExp,BSONRegExp_1=BSONRegExp;regexp.BSONRegExp=BSONRegExp_1,_Symbol.prototype.valueOf=function(){return this.value},_Symbol.prototype.toString=function(){return this.value},_Symbol.prototype.inspect=function(){return this.value},_Symbol.prototype.toJSON=function(){return this.value};var symbol=_Symbol,Symbol_1=_Symbol;symbol.Symbol=Symbol_1,Int32.prototype.valueOf=function(){return this.value},Int32.prototype.toJSON=function(){return this.value};var int_32=Int32,Int32_1=Int32;int_32.Int32=Int32_1,Code.prototype.toJSON=function(){return{scope:this.scope,code:this.code}};var code=Code,Code_1=Code;code.Code=Code_1;var PARSE_STRING_REGEXP=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,PARSE_INF_REGEXP=/^(\+|-)?(Infinity|inf)$/i,PARSE_NAN_REGEXP=/^(\+|-)?NaN$/i,EXPONENT_MAX=6111,EXPONENT_MIN=-6176,EXPONENT_BIAS=6176,NAN_BUFFER=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),INF_NEGATIVE_BUFFER=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),INF_POSITIVE_BUFFER=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),EXPONENT_REGEX=/^([-+])?(\d+)?$/,isDigit=function(e){return!isNaN(parseInt(e,10))},divideu128=function(e){var t=long_1.fromNumber(1e9),r=long_1.fromNumber(0);if(!(e.parts[0]||e.parts[1]||e.parts[2]||e.parts[3]))return{quotient:e,rem:r};for(var n=0;n<=3;n++)r=r.shiftLeft(32),r=r.add(new long_1(e.parts[n],0)),e.parts[n]=r.div(t).low_,r=r.modulo(t);return{quotient:e,rem:r}},multiply64x2=function(e,t){if(!e&&!t)return{high:long_1.fromNumber(0),low:long_1.fromNumber(0)};var r=e.shiftRightUnsigned(32),n=new long_1(e.getLowBits(),0),i=t.shiftRightUnsigned(32),o=new long_1(t.getLowBits(),0),u=r.multiply(i),s=r.multiply(o),a=n.multiply(i),f=n.multiply(o);return u=u.add(s.shiftRightUnsigned(32)),s=new long_1(s.getLowBits(),0).add(a).add(f.shiftRightUnsigned(32)),u=u.add(s.shiftRightUnsigned(32)),f=s.shiftLeft(32).add(new long_1(f.getLowBits(),0)),{high:u,low:f}},lessThan=function(e,t){var r=e.high_>>>0,n=t.high_>>>0;if(r<n)return!0;if(r===n){if(e.low_>>>0<t.low_>>>0)return!0}return!1},invalidErr=function(e,t){throw new TypeError('"${string}" not a valid Decimal128 string - '+t)};Decimal128.fromString=function(e){var t=!1,r=!1,n=!1,i=0,o=0,u=0,s=0,a=0,f=[0],c=0,l=0,h=0,p=0,d=0,g=0,_=[0,0],y=[0,0],b=0,v=0;if(e.length>=7e3)throw new TypeError(e+" not a valid Decimal128 string");var m=e.match(PARSE_STRING_REGEXP),B=e.match(PARSE_INF_REGEXP),S=e.match(PARSE_NAN_REGEXP);if(!m&&!B&&!S||0===e.length)throw new TypeError(e+" not a valid Decimal128 string");if(m){var E=m[2],O=m[4],w=m[5],N=m[6];O&&void 0===N&&invalidErr(e,"missing exponent power"),O&&void 0===E&&invalidErr(e,"missing exponent base"),void 0===O&&(w||N)&&invalidErr(e,"missing e before exponent")}if("+"!==e[v]&&"-"!==e[v]||(t="-"===e[v++]),!isDigit(e[v])&&"."!==e[v]){if("i"===e[v]||"I"===e[v])return new Decimal128(new Buffer(t?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER));if("N"===e[v])return new Decimal128(new Buffer(NAN_BUFFER))}for(;isDigit(e[v])||"."===e[v];)"."!==e[v]?(c<34&&("0"!==e[v]||n)&&(n||(a=o),n=!0,f[l++]=parseInt(e[v],10),c+=1),n&&(u+=1),r&&(s+=1),o+=1,v+=1):(r&&invalidErr(e,"contains multiple periods"),r=!0,v+=1);if(r&&!o)throw new TypeError(e+" not a valid Decimal128 string");if("e"===e[v]||"E"===e[v]){var A=e.substr(++v).match(EXPONENT_REGEX);if(!A||!A[2])return new Decimal128(new Buffer(NAN_BUFFER));d=parseInt(A[0],10),v+=A[0].length}if(e[v])return new Decimal128(new Buffer(NAN_BUFFER));if(h=0,c){if(p=c-1,1!==(i=u))for(;"0"===e[a+i-1];)i-=1}else h=0,p=0,f[0]=0,u=1,c=1,i=0;for(d<=s&&s-d>16384?d=EXPONENT_MIN:d-=s;d>EXPONENT_MAX;){if((p+=1)-h>34){var T=f.join("");if(T.match(/^0+$/)){d=EXPONENT_MAX;break}invalidErr(e,"overflow")}d-=1}for(;d<EXPONENT_MIN||c<u;){if(0===p&&i<c){d=EXPONENT_MIN,i=0;break}if(c<u?u-=1:p-=1,d<EXPONENT_MAX)d+=1;else{if(T=f.join(""),T.match(/^0+$/)){d=EXPONENT_MAX;break}invalidErr(e,"overflow")}}if(p-h+1<i){var I=o;r&&(a+=1,I+=1),t&&(a+=1,I+=1);var R=parseInt(e[a+p+1],10),D=0;if(R>=5&&(D=1,5===R))for(D=f[p]%2==1,g=a+p+2;g<I;g++)if(parseInt(e[g],10)){D=1;break}if(D)for(var P=p;P>=0;P--)if(++f[P]>9&&(f[P]=0,0===P)){if(!(d<EXPONENT_MAX))return new Decimal128(new Buffer(t?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER));d+=1,f[P]=1}}if(_=long_1.fromNumber(0),y=long_1.fromNumber(0),0===i)_=long_1.fromNumber(0),y=long_1.fromNumber(0);else if(p-h<17)for(P=h,y=long_1.fromNumber(f[P++]),_=new long_1(0,0);P<=p;P++)y=y.multiply(long_1.fromNumber(10)),y=y.add(long_1.fromNumber(f[P]));else{for(P=h,_=long_1.fromNumber(f[P++]);P<=p-17;P++)_=_.multiply(long_1.fromNumber(10)),_=_.add(long_1.fromNumber(f[P]));for(y=long_1.fromNumber(f[P++]);P<=p;P++)y=y.multiply(long_1.fromNumber(10)),y=y.add(long_1.fromNumber(f[P]))}var L=multiply64x2(_,long_1.fromString("100000000000000000"));L.low=L.low.add(y),lessThan(L.low,y)&&(L.high=L.high.add(long_1.fromNumber(1))),b=d+EXPONENT_BIAS;var $={low:long_1.fromNumber(0),high:long_1.fromNumber(0)};L.high.shiftRightUnsigned(49).and(long_1.fromNumber(1)).equals(long_1.fromNumber)?($.high=$.high.or(long_1.fromNumber(3).shiftLeft(61)),$.high=$.high.or(long_1.fromNumber(b).and(long_1.fromNumber(16383).shiftLeft(47))),$.high=$.high.or(L.high.and(long_1.fromNumber(0x7fffffffffff)))):($.high=$.high.or(long_1.fromNumber(16383&b).shiftLeft(49)),$.high=$.high.or(L.high.and(long_1.fromNumber(562949953421311)))),$.low=L.low,t&&($.high=$.high.or(long_1.fromString("9223372036854775808")));var k=new Buffer(16);return v=0,k[v++]=255&$.low.low_,k[v++]=$.low.low_>>8&255,k[v++]=$.low.low_>>16&255,k[v++]=$.low.low_>>24&255,k[v++]=255&$.low.high_,k[v++]=$.low.high_>>8&255,k[v++]=$.low.high_>>16&255,k[v++]=$.low.high_>>24&255,k[v++]=255&$.high.low_,k[v++]=$.high.low_>>8&255,k[v++]=$.high.low_>>16&255,k[v++]=$.high.low_>>24&255,k[v++]=255&$.high.high_,k[v++]=$.high.high_>>8&255,k[v++]=$.high.high_>>16&255,k[v++]=$.high.high_>>24&255,new Decimal128(k)};var EXPONENT_MASK=16383;EXPONENT_BIAS=6176,Decimal128.prototype.toString=function(){for(var e,t,r,n,i,o,u=0,s=new Array(36),a=0;a<s.length;a++)s[a]=0;var f,c,l,h,p,d=0,g=!1,_={parts:new Array(4)},y=[];d=0;var b=this.bytes;if(n=b[d++]|b[d++]<<8|b[d++]<<16|b[d++]<<24,r=b[d++]|b[d++]<<8|b[d++]<<16|b[d++]<<24,t=b[d++]|b[d++]<<8|b[d++]<<16|b[d++]<<24,e=b[d++]|b[d++]<<8|b[d++]<<16|b[d++]<<24,d=0,{low:new long_1(n,r),high:new long_1(t,e)}.high.lessThan(long_1.ZERO)&&y.push("-"),(i=e>>26&31)>>3==3){if(30===i)return y.join("")+"Infinity";if(31===i)return"NaN";o=e>>15&EXPONENT_MASK,l=8+(e>>14&1)}else l=e>>14&7,o=e>>17&EXPONENT_MASK;if(f=o-EXPONENT_BIAS,_.parts[0]=(16383&e)+((15&l)<<14),_.parts[1]=t,_.parts[2]=r,_.parts[3]=n,0===_.parts[0]&&0===_.parts[1]&&0===_.parts[2]&&0===_.parts[3])g=!0;else for(p=3;p>=0;p--){var v=0,m=divideu128(_);if(_=m.quotient,v=m.rem.low_)for(h=8;h>=0;h--)s[9*p+h]=v%10,v=Math.floor(v/10)}if(g)u=1,s[d]=0;else for(u=36,a=0;!s[d];)a++,u-=1,d+=1;if((c=u-1+f)>=34||c<=-7||f>0){if(u>34)return y.push(0),f>0?y.push("E+"+f):f<0&&y.push("E"+f),y.join("");for(y.push(s[d++]),u-=1,u&&y.push("."),a=0;a<u;a++)y.push(s[d++]);y.push("E"),c>0?y.push("+"+c):y.push(c)}else if(f>=0)for(a=0;a<u;a++)y.push(s[d++]);else{var B=u+f;if(B>0)for(a=0;a<B;a++)y.push(s[d++]);else y.push("0");for(y.push(".");B++<0;)y.push("0");for(a=0;a<u-Math.max(B-1,0);a++)y.push(s[d++])}return y.join("")},Decimal128.prototype.toJSON=function(){return{$numberDecimal:this.toString()}};var decimal128=Decimal128,Decimal128_1=Decimal128;decimal128.Decimal128=Decimal128_1;var min_key=MinKey,MinKey_1=MinKey;min_key.MinKey=MinKey_1;var max_key=MaxKey,MaxKey_1=MaxKey;max_key.MaxKey=MaxKey_1,DBRef.prototype.toJSON=function(){var e={$ref:this.collection,$id:this.oid};return null!=this.db&&(e.$db=this.db),e=Object.assign(e,this.fields)};var db_ref=DBRef,DBRef_1=DBRef;db_ref.DBRef=DBRef_1;var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,inited=!1,toString={}.toString,isArray=Array.isArray||function(e){return"[object Array]"==toString.call(e)},INSPECT_MAX_BYTES=50;Buffer$1.TYPED_ARRAY_SUPPORT=void 0===global.TYPED_ARRAY_SUPPORT||global.TYPED_ARRAY_SUPPORT;var _kMaxLength=kMaxLength();Buffer$1.poolSize=8192,Buffer$1._augment=function(e){return e.__proto__=Buffer$1.prototype,e},Buffer$1.from=function(e,t,r){return from(null,e,t,r)},Buffer$1.TYPED_ARRAY_SUPPORT&&(Buffer$1.prototype.__proto__=Uint8Array.prototype,Buffer$1.__proto__=Uint8Array),Buffer$1.alloc=function(e,t,r){return alloc(null,e,t,r)},Buffer$1.allocUnsafe=function(e){return allocUnsafe(null,e)},Buffer$1.allocUnsafeSlow=function(e){return allocUnsafe(null,e)},Buffer$1.isBuffer=isBuffer,Buffer$1.compare=function(e,t){if(!internalIsBuffer(e)||!internalIsBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},Buffer$1.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer$1.concat=function(e,t){if(!isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer$1.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Buffer$1.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!internalIsBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},Buffer$1.byteLength=byteLength,Buffer$1.prototype._isBuffer=!0,Buffer$1.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer$1.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer$1.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer$1.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer$1.prototype.equals=function(e){if(!internalIsBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer$1.compare(this,e)},Buffer$1.prototype.inspect=function(){var e="",t=INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},Buffer$1.prototype.compare=function(e,t,r,n,i){if(!internalIsBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var o=i-n,u=r-t,s=Math.min(o,u),a=this.slice(n,i),f=e.slice(t,r),c=0;c<s;++c)if(a[c]!==f[c]){o=a[c],u=f[c];break}return o<u?-1:u<o?1:0},Buffer$1.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer$1.prototype.indexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer$1.prototype.lastIndexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer$1.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return utf8Write(this,e,t,r);case"ascii":return asciiWrite(this,e,t,r);case"latin1":case"binary":return latin1Write(this,e,t,r);case"base64":return base64Write(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},Buffer$1.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer$1.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(Buffer$1.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=Buffer$1.prototype;else{var i=t-e;n=new Buffer$1(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},Buffer$1.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},Buffer$1.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},Buffer$1.prototype.readUInt8=function(e,t){return t||checkOffset(e,1,this.length),this[e]},Buffer$1.prototype.readUInt16LE=function(e,t){return t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer$1.prototype.readUInt16BE=function(e,t){return t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer$1.prototype.readUInt32LE=function(e,t){return t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer$1.prototype.readUInt32BE=function(e,t){return t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer$1.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},Buffer$1.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},Buffer$1.prototype.readInt8=function(e,t){return t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer$1.prototype.readInt16LE=function(e,t){t||checkOffset(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer$1.prototype.readInt16BE=function(e,t){t||checkOffset(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer$1.prototype.readInt32LE=function(e,t){return t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer$1.prototype.readInt32BE=function(e,t){return t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer$1.prototype.readFloatLE=function(e,t){return t||checkOffset(e,4,this.length),read(this,e,!0,23,4)},Buffer$1.prototype.readFloatBE=function(e,t){return t||checkOffset(e,4,this.length),read(this,e,!1,23,4)},Buffer$1.prototype.readDoubleLE=function(e,t){return t||checkOffset(e,8,this.length),read(this,e,!0,52,8)},Buffer$1.prototype.readDoubleBE=function(e,t){return t||checkOffset(e,8,this.length),read(this,e,!1,52,8)},Buffer$1.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){checkInt(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},Buffer$1.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){checkInt(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},Buffer$1.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,255,0),Buffer$1.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Buffer$1.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer$1.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer$1.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer$1.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer$1.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer$1.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):objectWriteUInt32(this,e,t,!0),t+4},Buffer$1.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer$1.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer$1.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);checkInt(this,e,t,r,i-1,-i)}var o=0,u=1,s=0;for(this[t]=255&e;++o<r&&(u*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/u>>0)-s&255;return t+r},Buffer$1.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);checkInt(this,e,t,r,i-1,-i)}var o=r-1,u=1,s=0;for(this[t+o]=255&e;--o>=0&&(u*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/u>>0)-s&255;return t+r},Buffer$1.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,127,-128),Buffer$1.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer$1.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer$1.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer$1.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer$1.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer$1.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),Buffer$1.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):objectWriteUInt32(this,e,t,!0),t+4},Buffer$1.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Buffer$1.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer$1.prototype.writeFloatLE=function(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer$1.prototype.writeFloatBE=function(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer$1.prototype.writeDoubleLE=function(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer$1.prototype.writeDoubleBE=function(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer$1.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!Buffer$1.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},Buffer$1.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer$1.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var o;if("number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var u=internalIsBuffer(e)?e:utf8ToBytes(new Buffer$1(e,n).toString()),s=u.length;for(o=0;o<r-t;++o)this[o+t]=u[o%s]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g,bufferEs6=Object.freeze({INSPECT_MAX_BYTES:INSPECT_MAX_BYTES,kMaxLength:_kMaxLength,Buffer:Buffer$1,SlowBuffer:SlowBuffer,isBuffer:isBuffer});if(void 0!==commonjsGlobal)var Buffer$2=bufferEs6.Buffer;Binary.prototype.put=function(e){if(null!=e.length&&"number"!=typeof e&&1!==e.length)throw new TypeError("only accepts single character String, Uint8Array or Array");if("number"!=typeof e&&e<0||e>255)throw new TypeError("only accepts number in a valid unsigned byte range 0-255");var t=null;if(t="string"==typeof e?e.charCodeAt(0):null!=e.length?e[0]:e,this.buffer.length>this.position)this.buffer[this.position++]=t;else if(void 0!==Buffer$2&&Buffer$2.isBuffer(this.buffer)){var r=new Buffer$2(Binary.BUFFER_SIZE+this.buffer.length);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r,this.buffer[this.position++]=t}else{r=null,r="[object Uint8Array]"===Object.prototype.toString.call(this.buffer)?new Uint8Array(new ArrayBuffer(Binary.BUFFER_SIZE+this.buffer.length)):new Array(Binary.BUFFER_SIZE+this.buffer.length);for(var n=0;n<this.buffer.length;n++)r[n]=this.buffer[n];this.buffer=r,this.buffer[this.position++]=t}},Binary.prototype.write=function(e,t){if(t="number"==typeof t?t:this.position,this.buffer.length<t+e.length){var r=null;if(void 0!==Buffer$2&&Buffer$2.isBuffer(this.buffer))r=new Buffer$2(this.buffer.length+e.length),this.buffer.copy(r,0,0,this.buffer.length);else if("[object Uint8Array]"===Object.prototype.toString.call(this.buffer)){r=new Uint8Array(new ArrayBuffer(this.buffer.length+e.length));for(var n=0;n<this.position;n++)r[n]=this.buffer[n]}this.buffer=r}if(void 0!==Buffer$2&&Buffer$2.isBuffer(e)&&Buffer$2.isBuffer(this.buffer))e.copy(this.buffer,t,0,e.length),this.position=t+e.length>this.position?t+e.length:this.position;else if(void 0!==Buffer$2&&"string"==typeof e&&Buffer$2.isBuffer(this.buffer))this.buffer.write(e,t,"binary"),this.position=t+e.length>this.position?t+e.length:this.position;else if("[object Uint8Array]"===Object.prototype.toString.call(e)||"[object Array]"===Object.prototype.toString.call(e)&&"string"!=typeof e){for(n=0;n<e.length;n++)this.buffer[t++]=e[n];this.position=t>this.position?t:this.position}else if("string"==typeof e){for(n=0;n<e.length;n++)this.buffer[t++]=e.charCodeAt(n);this.position=t>this.position?t:this.position}},Binary.prototype.read=function(e,t){if(t=t&&t>0?t:this.position,this.buffer.slice)return this.buffer.slice(e,e+t);for(var r="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(t)):new Array(t),n=0;n<t;n++)r[n]=this.buffer[e++];return r},Binary.prototype.value=function(e){if((e=null!=e&&e)&&void 0!==Buffer$2&&Buffer$2.isBuffer(this.buffer)&&this.buffer.length===this.position)return this.buffer;if(void 0!==Buffer$2&&Buffer$2.isBuffer(this.buffer))return e?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position);if(e){if(null!=this.buffer.slice)return this.buffer.slice(0,this.position);for(var t="[object Uint8Array]"===Object.prototype.toString.call(this.buffer)?new Uint8Array(new ArrayBuffer(this.position)):new Array(this.position),r=0;r<this.position;r++)t[r]=this.buffer[r];return t}return convertArraytoUtf8BinaryString(this.buffer,0,this.position)},Binary.prototype.length=function(){return this.position},Binary.prototype.toJSON=function(){return null!=this.buffer?this.buffer.toString("base64"):""},Binary.prototype.toString=function(e){return null!=this.buffer?this.buffer.slice(0,this.position).toString(e):""};var BSON_BINARY_SUBTYPE_DEFAULT=0,writeStringToArray=function(e){for(var t="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(e.length)):new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t},convertArraytoUtf8BinaryString=function(e,t,r){for(var n="",i=t;i<r;i++)n+=String.fromCharCode(e[i]);return n};Binary.BUFFER_SIZE=256,Binary.SUBTYPE_DEFAULT=0,Binary.SUBTYPE_FUNCTION=1,Binary.SUBTYPE_BYTE_ARRAY=2,Binary.SUBTYPE_UUID_OLD=3,Binary.SUBTYPE_UUID=4,Binary.SUBTYPE_MD5=5,Binary.SUBTYPE_USER_DEFINED=128;var binary=Binary,Binary_1=Binary;binary.Binary=Binary_1;var Long$1=long_1.Long,Double$1=double_1.Double,Timestamp$1=timestamp.Timestamp,ObjectID$1=objectid.ObjectID,Code$1=code.Code,MinKey$1=min_key.MinKey,MaxKey$1=max_key.MaxKey,DBRef$1=db_ref.DBRef,BSONRegExp$1=regexp.BSONRegExp,Binary$1=binary.Binary,deserialize=function(e,t,r){t=null==t?{}:t;var n=t&&t.index?t.index:0,i=e[n]|e[n+1]<<8|e[n+2]<<16|e[n+3]<<24;if(i<5)throw new Error("bson size must be >= 5, is "+i);if(t.allowObjectSmallerThanBufferSize&&e.length<i)throw new Error("buffer length "+e.length+" must be >= bson size "+i);if(!t.allowObjectSmallerThanBufferSize&&e.length!==i)throw new Error("buffer length "+e.length+" must === bson size "+i);if(i+n>e.length)throw new Error("(bson size "+i+" + options.index "+n+" must be <= buffer length "+e.length+")");if(0!==e[n+i-1])throw new Error("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return deserializeObject(e,n,t,r)},deserializeObject=function e(t,r,n,i){var o=null!=n.evalFunctions&&n.evalFunctions,u=null!=n.cacheFunctions&&n.cacheFunctions,s=null!=n.cacheFunctionsCrc32&&n.cacheFunctionsCrc32;if(!s)var a=null;var f=null==n.fieldsAsRaw?null:n.fieldsAsRaw,c=null!=n.raw&&n.raw,l="boolean"==typeof n.bsonRegExp&&n.bsonRegExp,h=null!=n.promoteBuffers&&n.promoteBuffers,p=null==n.promoteLongs||n.promoteLongs,d=null==n.promoteValues||n.promoteValues,g=r;if(t.length<5)throw new Error("corrupt bson message < 5 bytes long");var _=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;if(_<5||_>t.length)throw new Error("corrupt bson message");for(var y=i?[]:{},b=0;;){var v=t[r++];if(0===v)break;for(var m=r;0!==t[m]&&m<t.length;)m++;if(m>=t.length)throw new Error("Bad BSON Document: illegal CString");var B=i?b++:t.toString("utf8",r,m);if(r=m+1,v===BSON.BSON_DATA_STRING){var S=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;if(S<=0||S>t.length-r||0!==t[r+S-1])throw new Error("bad string length in bson");var E=t.toString("utf8",r,r+S-1);for(m=0;m<E.length;m++)if(65533===E.charCodeAt(m))throw new Error("Invalid UTF-8 string in BSON document");y[B]=E,r+=S}else if(v===BSON.BSON_DATA_OID){var O=new Buffer(12);t.copy(O,0,r,r+12),y[B]=new ObjectID$1(O),r+=12}else if(v===BSON.BSON_DATA_INT&&!1===d)y[B]=new int_32(t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24);else if(v===BSON.BSON_DATA_INT)y[B]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;else if(v===BSON.BSON_DATA_NUMBER&&!1===d)y[B]=new Double$1(t.readDoubleLE(r)),r+=8;else if(v===BSON.BSON_DATA_NUMBER)y[B]=t.readDoubleLE(r),r+=8;else if(v===BSON.BSON_DATA_DATE){var w=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24,N=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;y[B]=new Date(new Long$1(w,N).toNumber())}else if(v===BSON.BSON_DATA_BOOLEAN){if(0!==t[r]&&1!==t[r])throw new Error("illegal boolean type value");y[B]=1===t[r++]}else if(v===BSON.BSON_DATA_OBJECT){var A=r,T=t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24;if(T<=0||T>t.length-r)throw new Error("bad embedded document length in bson");y[B]=c?t.slice(r,r+T):e(t,A,n,!1),r+=T}else if(v===BSON.BSON_DATA_ARRAY){A=r,T=t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24;var I=n,R=r+T;if(f&&f[B]){I={};for(var D in n)I[D]=n[D];I.raw=!0}if(y[B]=e(t,A,I,!0),r+=T,0!==t[r-1])throw new Error("invalid array terminator byte");if(r!==R)throw new Error("corrupted array bson")}else if(v===BSON.BSON_DATA_UNDEFINED)y[B]=void 0;else if(v===BSON.BSON_DATA_NULL)y[B]=null;else if(v===BSON.BSON_DATA_LONG){w=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24,N=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;var P=new Long$1(w,N);y[B]=p&&!0===d&&P.lessThanOrEqual(JS_INT_MAX_LONG)&&P.greaterThanOrEqual(JS_INT_MIN_LONG)?P.toNumber():P}else if(v===BSON.BSON_DATA_DECIMAL128){var L=new Buffer(16);t.copy(L,0,r,r+16),r+=16;var $=new decimal128(L);y[B]=$.toObject?$.toObject():$}else if(v===BSON.BSON_DATA_BINARY){var k=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24,U=k,x=t[r++];if(k<0)throw new Error("Negative binary type element size found");if(k>t.length)throw new Error("Binary type size larger than document size");if(null!=t.slice){if(x===Binary$1.SUBTYPE_BYTE_ARRAY){if((k=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(k>U-4)throw new Error("Binary type with subtype 0x02 contains to long binary size");if(k<U-4)throw new Error("Binary type with subtype 0x02 contains to short binary size")}y[B]=h&&d?t.slice(r,r+k):new Binary$1(t.slice(r,r+k),x)}else{var M="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(k)):new Array(k);if(x===Binary$1.SUBTYPE_BYTE_ARRAY){if((k=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(k>U-4)throw new Error("Binary type with subtype 0x02 contains to long binary size");if(k<U-4)throw new Error("Binary type with subtype 0x02 contains to short binary size")}for(m=0;m<k;m++)M[m]=t[r+m];y[B]=h&&d?M:new Binary$1(M,x)}r+=k}else if(v===BSON.BSON_DATA_REGEXP&&!1===l){for(m=r;0!==t[m]&&m<t.length;)m++;if(m>=t.length)throw new Error("Bad BSON Document: illegal CString");var j=t.toString("utf8",r,m);for(r=m+1,m=r;0!==t[m]&&m<t.length;)m++;if(m>=t.length)throw new Error("Bad BSON Document: illegal CString");var C=t.toString("utf8",r,m);r=m+1;var Y=new Array(C.length);for(m=0;m<C.length;m++)switch(C[m]){case"m":Y[m]="m";break;case"s":Y[m]="g";break;case"i":Y[m]="i"}y[B]=new RegExp(j,Y.join(""))}else if(v===BSON.BSON_DATA_REGEXP&&!0===l){for(m=r;0!==t[m]&&m<t.length;)m++;if(m>=t.length)throw new Error("Bad BSON Document: illegal CString");for(j=t.toString("utf8",r,m),r=m+1,m=r;0!==t[m]&&m<t.length;)m++;if(m>=t.length)throw new Error("Bad BSON Document: illegal CString");C=t.toString("utf8",r,m),r=m+1,y[B]=new BSONRegExp$1(j,C)}else if(v===BSON.BSON_DATA_SYMBOL){if((S=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)<=0||S>t.length-r||0!==t[r+S-1])throw new Error("bad string length in bson");y[B]=t.toString("utf8",r,r+S-1),r+=S}else if(v===BSON.BSON_DATA_TIMESTAMP)w=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24,N=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24,y[B]=new Timestamp$1(w,N);else if(v===BSON.BSON_DATA_MIN_KEY)y[B]=new MinKey$1;else if(v===BSON.BSON_DATA_MAX_KEY)y[B]=new MaxKey$1;else if(v===BSON.BSON_DATA_CODE){if((S=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)<=0||S>t.length-r||0!==t[r+S-1])throw new Error("bad string length in bson");var F=t.toString("utf8",r,r+S-1);if(o)if(u){var z=s?a(F):F;y[B]=isolateEvalWithHash(functionCache,z,F,y)}else y[B]=isolateEval(F);else y[B]=new Code$1(F);r+=S}else if(v===BSON.BSON_DATA_CODE_W_SCOPE){var K=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;if(K<13)throw new Error("code_w_scope total size shorter minimum expected length");if((S=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)<=0||S>t.length-r||0!==t[r+S-1])throw new Error("bad string length in bson");F=t.toString("utf8",r,r+S-1),r+=S,A=r,T=t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24;var W=e(t,A,n,!1);if(r+=T,K<8+T+S)throw new Error("code_w_scope total size is to short, truncating scope");if(K>8+T+S)throw new Error("code_w_scope total size is to long, clips outer document");o?(u?(z=s?a(F):F,y[B]=isolateEvalWithHash(functionCache,z,F,y)):y[B]=isolateEval(F),y[B].scope=W):y[B]=new Code$1(F,W)}else{if(v!==BSON.BSON_DATA_DBPOINTER)throw new Error("Detected unknown BSON type "+v.toString(16)+' for fieldname "'+B+'", are you using the latest BSON parser?');if((S=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)<=0||S>t.length-r||0!==t[r+S-1])throw new Error("bad string length in bson");var J=t.toString("utf8",r,r+S-1);r+=S;var V=new Buffer(12);for(t.copy(V,0,r,r+12),O=new ObjectID$1(V),r+=12,m=0;m<J.length;m++)if(65533===J.charCodeAt(m))throw new Error("Invalid UTF-8 string in BSON document");y[B]=new DBRef$1(J,O)}}if(_!==r-g){if(i)throw new Error("corrupt array bson");throw new Error("corrupt object bson")}var X=Object.keys(y).filter(function(e){return e.startsWith("$")}),H=!0;if(X.forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(H=!1)}),!H)return y;if(null!=y.$id&&null!=y.$ref){var G=Object.assign({},y);return delete G.$ref,delete G.$id,delete G.$db,new DBRef$1(y.$ref,y.$id,y.$db||null,G)}return y},isolateEvalWithHash=function isolateEvalWithHash(functionCache,hash,functionString,object){var value=null;return null==functionCache[hash]&&(eval("value = "+functionString),functionCache[hash]=value),functionCache[hash].bind(object)},isolateEval=function isolateEval(functionString){var value=null;return eval("value = "+functionString),value},BSON={},functionCache=BSON.functionCache={};BSON.BSON_DATA_NUMBER=1,BSON.BSON_DATA_STRING=2,BSON.BSON_DATA_OBJECT=3,BSON.BSON_DATA_ARRAY=4,BSON.BSON_DATA_BINARY=5,BSON.BSON_DATA_UNDEFINED=6,BSON.BSON_DATA_OID=7,BSON.BSON_DATA_BOOLEAN=8,BSON.BSON_DATA_DATE=9,BSON.BSON_DATA_NULL=10,BSON.BSON_DATA_REGEXP=11,BSON.BSON_DATA_DBPOINTER=12,BSON.BSON_DATA_CODE=13,BSON.BSON_DATA_SYMBOL=14,BSON.BSON_DATA_CODE_W_SCOPE=15,BSON.BSON_DATA_INT=16,BSON.BSON_DATA_TIMESTAMP=17,BSON.BSON_DATA_LONG=18,BSON.BSON_DATA_DECIMAL128=19,BSON.BSON_DATA_MIN_KEY=255,BSON.BSON_DATA_MAX_KEY=127,BSON.BSON_BINARY_SUBTYPE_DEFAULT=0,BSON.BSON_BINARY_SUBTYPE_FUNCTION=1,BSON.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,BSON.BSON_BINARY_SUBTYPE_UUID=3,BSON.BSON_BINARY_SUBTYPE_MD5=4,BSON.BSON_BINARY_SUBTYPE_USER_DEFINED=128,BSON.BSON_INT32_MAX=2147483647,BSON.BSON_INT32_MIN=-2147483648,BSON.BSON_INT64_MAX=Math.pow(2,63)-1,BSON.BSON_INT64_MIN=-Math.pow(2,63),BSON.JS_INT_MAX=9007199254740992,BSON.JS_INT_MIN=-9007199254740992;var JS_INT_MAX_LONG=Long$1.fromNumber(9007199254740992),JS_INT_MIN_LONG=Long$1.fromNumber(-9007199254740992),deserializer=deserialize,readIEEE754=function(e,t,r,n,i){var o,u,s="big"===r,a=8*i-n-1,f=(1<<a)-1,c=f>>1,l=-7,h=s?0:i-1,p=s?1:-1,d=e[t+h];for(h+=p,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=p,l-=8);for(u=o&(1<<-l)-1,o>>=-l,l+=n;l>0;u=256*u+e[t+h],h+=p,l-=8);if(0===o)o=1-c;else{if(o===f)return u?NaN:1/0*(d?-1:1);u+=Math.pow(2,n),o-=c}return(d?-1:1)*u*Math.pow(2,o-n)},writeIEEE754=function(e,t,r,n,i,o){var u,s,a,f="big"===n,c=8*o-i-1,l=(1<<c)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=f?o-1:0,g=f?-1:1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,u=l):(u=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-u))<1&&(u--,a*=2),t+=u+h>=1?p/a:p*Math.pow(2,1-h),t*a>=2&&(u++,a/=2),u+h>=l?(s=0,u=l):u+h>=1?(s=(t*a-1)*Math.pow(2,i),u+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),u=0)),isNaN(t)&&(s=0);i>=8;)e[r+d]=255&s,d+=g,s/=256,i-=8;for(u=u<<i|s,isNaN(t)&&(u+=8),c+=i;c>0;)e[r+d]=255&u,d+=g,u/=256,c-=8;e[r+d-g]|=128*_},readIEEE754_1=readIEEE754,writeIEEE754_1=writeIEEE754,float_parser={readIEEE754:readIEEE754_1,writeIEEE754:writeIEEE754_1},utils={normalizedFunctionString:normalizedFunctionString},_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)},writeIEEE754$1=float_parser.writeIEEE754,Long$2=long_1.Long,MinKey$2=min_key.MinKey,Binary$2=binary.Binary,normalizedFunctionString$1=utils.normalizedFunctionString,regexp$1=/\x00/,isDate=function(e){return"object"===(void 0===e?"undefined":_typeof(e))&&"[object Date]"===Object.prototype.toString.call(e)},isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},serializeString=function(e,t,r,n,i){e[n++]=BSON$1.BSON_DATA_STRING,n=n+(i?e.write(t,n,"ascii"):e.write(t,n,"utf8"))+1,e[n-1]=0;var o=e.write(r,n+4,"utf8");return e[n+3]=o+1>>24&255,e[n+2]=o+1>>16&255,e[n+1]=o+1>>8&255,e[n]=o+1&255,n=n+4+o,e[n++]=0,n},serializeNumber=function(e,t,r,n,i){if(Math.floor(r)===r&&r>=BSON$1.JS_INT_MIN&&r<=BSON$1.JS_INT_MAX)if(r>=BSON$1.BSON_INT32_MIN&&r<=BSON$1.BSON_INT32_MAX){e[n++]=BSON$1.BSON_DATA_INT;var o=i?e.write(t,n,"ascii"):e.write(t,n,"utf8");n+=o,e[n++]=0,e[n++]=255&r,e[n++]=r>>8&255,e[n++]=r>>16&255,e[n++]=r>>24&255}else if(r>=BSON$1.JS_INT_MIN&&r<=BSON$1.JS_INT_MAX)e[n++]=BSON$1.BSON_DATA_NUMBER,o=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),n+=o,e[n++]=0,writeIEEE754$1(e,r,n,"little",52,8),n+=8;else{e[n++]=BSON$1.BSON_DATA_LONG,o=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),n+=o,e[n++]=0;var u=Long$2.fromNumber(r),s=u.getLowBits(),a=u.getHighBits();e[n++]=255&s,e[n++]=s>>8&255,e[n++]=s>>16&255,e[n++]=s>>24&255,e[n++]=255&a,e[n++]=a>>8&255,e[n++]=a>>16&255,e[n++]=a>>24&255}else e[n++]=BSON$1.BSON_DATA_NUMBER,o=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),n+=o,e[n++]=0,writeIEEE754$1(e,r,n,"little",52,8),n+=8;return n},serializeNull=function(e,t,r,n,i){return e[n++]=BSON$1.BSON_DATA_NULL,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,n},serializeBoolean=function(e,t,r,n,i){return e[n++]=BSON$1.BSON_DATA_BOOLEAN,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,e[n++]=r?1:0,n},serializeDate=function(e,t,r,n,i){e[n++]=BSON$1.BSON_DATA_DATE,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0;var o=Long$2.fromNumber(r.getTime()),u=o.getLowBits(),s=o.getHighBits();return e[n++]=255&u,e[n++]=u>>8&255,e[n++]=u>>16&255,e[n++]=u>>24&255,e[n++]=255&s,e[n++]=s>>8&255,e[n++]=s>>16&255,e[n++]=s>>24&255,n},serializeRegExp=function(e,t,r,n,i){if(e[n++]=BSON$1.BSON_DATA_REGEXP,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,r.source&&null!=r.source.match(regexp$1))throw Error("value "+r.source+" must not contain null bytes");return n+=e.write(r.source,n,"utf8"),e[n++]=0,r.ignoreCase&&(e[n++]=105),r.global&&(e[n++]=115),r.multiline&&(e[n++]=109),e[n++]=0,n},serializeBSONRegExp=function(e,t,r,n,i){if(e[n++]=BSON$1.BSON_DATA_REGEXP,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,null!=r.pattern.match(regexp$1))throw Error("pattern "+r.pattern+" must not contain null bytes");return n+=e.write(r.pattern,n,"utf8"),e[n++]=0,n+=e.write(r.options.split("").sort().join(""),n,"utf8"),e[n++]=0,n},serializeMinMax=function(e,t,r,n,i){return e[n++]=null===r?BSON$1.BSON_DATA_NULL:r instanceof MinKey$2?BSON$1.BSON_DATA_MIN_KEY:BSON$1.BSON_DATA_MAX_KEY,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,n},serializeObjectId=function(e,t,r,n,i){if(e[n++]=BSON$1.BSON_DATA_OID,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,"string"==typeof r.id)e.write(r.id,n,"binary");else{if(!r.id||!r.id.copy)throw new TypeError("object ["+JSON.stringify(r)+"] is not a valid ObjectId");r.id.copy(e,n,0,12)}return n+12},serializeBuffer=function(e,t,r,n,i){e[n++]=BSON$1.BSON_DATA_BINARY,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0;var o=r.length;return e[n++]=255&o,e[n++]=o>>8&255,e[n++]=o>>16&255,e[n++]=o>>24&255,e[n++]=BSON$1.BSON_BINARY_SUBTYPE_DEFAULT,r.copy(e,n,0,o),n+=o},serializeObject=function(e,t,r,n,i,o,u,s,a,f){for(var c=0;c<f.length;c++)if(f[c]===r)throw new Error("cyclic dependency detected");f.push(r),e[n++]=Array.isArray(r)?BSON$1.BSON_DATA_ARRAY:BSON$1.BSON_DATA_OBJECT,n+=a?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0;var l=serializeInto(e,r,i,n,o+1,u,s,f);return f.pop(),l},serializeDecimal128=function(e,t,r,n,i){return e[n++]=BSON$1.BSON_DATA_DECIMAL128,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,r.bytes.copy(e,n,0,16),n+16},serializeLong=function(e,t,r,n,i){e[n++]="Long"===r._bsontype?BSON$1.BSON_DATA_LONG:BSON$1.BSON_DATA_TIMESTAMP,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0;var o=r.getLowBits(),u=r.getHighBits();return e[n++]=255&o,e[n++]=o>>8&255,e[n++]=o>>16&255,e[n++]=o>>24&255,e[n++]=255&u,e[n++]=u>>8&255,e[n++]=u>>16&255,e[n++]=u>>24&255,n},serializeInt32=function(e,t,r,n,i){return e[n++]=BSON$1.BSON_DATA_INT,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,e[n++]=255&r,e[n++]=r>>8&255,e[n++]=r>>16&255,e[n++]=r>>24&255,n},serializeDouble=function(e,t,r,n,i){return e[n++]=BSON$1.BSON_DATA_NUMBER,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0,writeIEEE754$1(e,r.value,n,"little",52,8),n+=8},serializeFunction=function(e,t,r,n,i,o,u){e[n++]=BSON$1.BSON_DATA_CODE,n+=u?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0;var s=normalizedFunctionString$1(r),a=e.write(s,n+4,"utf8")+1;return e[n]=255&a,e[n+1]=a>>8&255,e[n+2]=a>>16&255,e[n+3]=a>>24&255,n=n+4+a-1,e[n++]=0,n},serializeCode=function(e,t,r,n,i,o,u,s,a){if(r.scope&&"object"===_typeof(r.scope)){e[n++]=BSON$1.BSON_DATA_CODE_W_SCOPE;var f=a?e.write(t,n,"ascii"):e.write(t,n,"utf8");n+=f,e[n++]=0;var c=n,l="string"==typeof r.code?r.code:r.code.toString();n+=4;var h=e.write(l,n+4,"utf8")+1;e[n]=255&h,e[n+1]=h>>8&255,e[n+2]=h>>16&255,e[n+3]=h>>24&255,e[n+4+h-1]=0,n=n+h+4;var p=serializeInto(e,r.scope,i,n,o+1,u,s);n=p-1;var d=p-c;e[c++]=255&d,e[c++]=d>>8&255,e[c++]=d>>16&255,e[c++]=d>>24&255,e[n++]=0}else{e[n++]=BSON$1.BSON_DATA_CODE,f=a?e.write(t,n,"ascii"):e.write(t,n,"utf8"),n+=f,e[n++]=0,l=r.code.toString();var g=e.write(l,n+4,"utf8")+1;e[n]=255&g,e[n+1]=g>>8&255,e[n+2]=g>>16&255,e[n+3]=g>>24&255,n=n+4+g-1,e[n++]=0}return n},serializeBinary=function(e,t,r,n,i){e[n++]=BSON$1.BSON_DATA_BINARY,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0;var o=r.value(!0),u=r.position;return r.sub_type===Binary$2.SUBTYPE_BYTE_ARRAY&&(u+=4),e[n++]=255&u,e[n++]=u>>8&255,e[n++]=u>>16&255,e[n++]=u>>24&255,e[n++]=r.sub_type,r.sub_type===Binary$2.SUBTYPE_BYTE_ARRAY&&(u-=4,e[n++]=255&u,e[n++]=u>>8&255,e[n++]=u>>16&255,e[n++]=u>>24&255),o.copy(e,n,0,r.position),n+=r.position},serializeSymbol=function(e,t,r,n,i){e[n++]=BSON$1.BSON_DATA_SYMBOL,n+=i?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0;var o=e.write(r.value,n+4,"utf8")+1;return e[n]=255&o,e[n+1]=o>>8&255,e[n+2]=o>>16&255,e[n+3]=o>>24&255,n=n+4+o-1,e[n++]=0,n},serializeDBRef=function(e,t,r,n,i,o,u){e[n++]=BSON$1.BSON_DATA_OBJECT,n+=u?e.write(t,n,"ascii"):e.write(t,n,"utf8"),e[n++]=0;var s,a=n,f={$ref:r.collection,$id:r.oid};null!=r.db&&(f.$db=r.db),f=Object.assign(f,r.fields),s=serializeInto(e,f,!1,n,i+1,o);var c=s-a;return e[a++]=255&c,e[a++]=c>>8&255,e[a++]=c>>16&255,e[a++]=c>>24&255,s},serializeInto=function(e,t,r,n,i,o,u,s){n=n||0,s=s||[],s.push(t);var a=n+4;if(Array.isArray(t))for(var f=0;f<t.length;f++){var c=""+f,l=t[f];if(l&&l.toBSON){if("function"!=typeof l.toBSON)throw new TypeError("toBSON is not a function");l=l.toBSON()}var h=void 0===l?"undefined":_typeof(l);"string"===h?a=serializeString(e,c,l,a,!0):"number"===h?a=serializeNumber(e,c,l,a,!0):"boolean"===h?a=serializeBoolean(e,c,l,a,!0):l instanceof Date||isDate(l)?a=serializeDate(e,c,l,a,!0):void 0===l?a=serializeNull(e,c,l,a,!0):null===l?a=serializeNull(e,c,l,a,!0):"ObjectID"===l._bsontype?a=serializeObjectId(e,c,l,a,!0):Buffer.isBuffer(l)?a=serializeBuffer(e,c,l,a,!0):l instanceof RegExp||isRegExp(l)?a=serializeRegExp(e,c,l,a,!0):"object"===h&&null==l._bsontype?a=serializeObject(e,c,l,a,r,i,o,u,!0,s):"object"===h&&"Decimal128"===l._bsontype?a=serializeDecimal128(e,c,l,a,!0):"Long"===l._bsontype||"Timestamp"===l._bsontype?a=serializeLong(e,c,l,a,!0):"Double"===l._bsontype?a=serializeDouble(e,c,l,a,!0):"function"==typeof l&&o?a=serializeFunction(e,c,l,a,r,i,o,!0):"Code"===l._bsontype?a=serializeCode(e,c,l,a,r,i,o,u,!0):"Binary"===l._bsontype?a=serializeBinary(e,c,l,a,!0):"Symbol"===l._bsontype?a=serializeSymbol(e,c,l,a,!0):"DBRef"===l._bsontype?a=serializeDBRef(e,c,l,a,i,o,!0):"BSONRegExp"===l._bsontype?a=serializeBSONRegExp(e,c,l,a,!0):"Int32"===l._bsontype?a=serializeInt32(e,c,l,a,!0):"MinKey"!==l._bsontype&&"MaxKey"!==l._bsontype||(a=serializeMinMax(e,c,l,a,!0))}else if(t instanceof map)for(var p=t.entries(),d=!1;!d;){var g=p.next();if(!(d=g.done)){if(c=g.value[0],l=g.value[1],h=void 0===l?"undefined":_typeof(l),"$db"!==c&&"$ref"!==c&&"$id"!==c){if(null!=c.match(regexp$1))throw Error("key "+c+" must not contain null bytes");if(r){if("$"===c[0])throw Error("key "+c+" must not start with '$'");if(~c.indexOf("."))throw Error("key "+c+" must not contain '.'")}}"string"===h?a=serializeString(e,c,l,a):"number"===h?a=serializeNumber(e,c,l,a):"boolean"===h?a=serializeBoolean(e,c,l,a):l instanceof Date||isDate(l)?a=serializeDate(e,c,l,a):null===l||void 0===l&&!1===u?a=serializeNull(e,c,l,a):"ObjectID"===l._bsontype?a=serializeObjectId(e,c,l,a):Buffer.isBuffer(l)?a=serializeBuffer(e,c,l,a):l instanceof RegExp||isRegExp(l)?a=serializeRegExp(e,c,l,a):"object"===h&&null==l._bsontype?a=serializeObject(e,c,l,a,r,i,o,u,!1,s):"object"===h&&"Decimal128"===l._bsontype?a=serializeDecimal128(e,c,l,a):"Long"===l._bsontype||"Timestamp"===l._bsontype?a=serializeLong(e,c,l,a):"Double"===l._bsontype?a=serializeDouble(e,c,l,a):"Code"===l._bsontype?a=serializeCode(e,c,l,a,r,i,o,u):"function"==typeof l&&o?a=serializeFunction(e,c,l,a,r,i,o):"Binary"===l._bsontype?a=serializeBinary(e,c,l,a):"Symbol"===l._bsontype?a=serializeSymbol(e,c,l,a):"DBRef"===l._bsontype?a=serializeDBRef(e,c,l,a,i,o):"BSONRegExp"===l._bsontype?a=serializeBSONRegExp(e,c,l,a):"Int32"===l._bsontype?a=serializeInt32(e,c,l,a):"MinKey"!==l._bsontype&&"MaxKey"!==l._bsontype||(a=serializeMinMax(e,c,l,a))}}else{if(t.toBSON){if("function"!=typeof t.toBSON)throw new TypeError("toBSON is not a function");if(null!=(t=t.toBSON())&&"object"!==(void 0===t?"undefined":_typeof(t)))throw new TypeError("toBSON function did not return an object")}for(c in t){if((l=t[c])&&l.toBSON){if("function"!=typeof l.toBSON)throw new TypeError("toBSON is not a function");l=l.toBSON()}if(h=void 0===l?"undefined":_typeof(l),"$db"!==c&&"$ref"!==c&&"$id"!==c){if(null!=c.match(regexp$1))throw Error("key "+c+" must not contain null bytes");if(r){if("$"===c[0])throw Error("key "+c+" must not start with '$'");if(~c.indexOf("."))throw Error("key "+c+" must not contain '.'")}}"string"===h?a=serializeString(e,c,l,a):"number"===h?a=serializeNumber(e,c,l,a):"boolean"===h?a=serializeBoolean(e,c,l,a):l instanceof Date||isDate(l)?a=serializeDate(e,c,l,a):void 0===l?!1===u&&(a=serializeNull(e,c,l,a)):null===l?a=serializeNull(e,c,l,a):"ObjectID"===l._bsontype?a=serializeObjectId(e,c,l,a):Buffer.isBuffer(l)?a=serializeBuffer(e,c,l,a):l instanceof RegExp||isRegExp(l)?a=serializeRegExp(e,c,l,a):"object"===h&&null==l._bsontype?a=serializeObject(e,c,l,a,r,i,o,u,!1,s):"object"===h&&"Decimal128"===l._bsontype?a=serializeDecimal128(e,c,l,a):"Long"===l._bsontype||"Timestamp"===l._bsontype?a=serializeLong(e,c,l,a):"Double"===l._bsontype?a=serializeDouble(e,c,l,a):"Code"===l._bsontype?a=serializeCode(e,c,l,a,r,i,o,u):"function"==typeof l&&o?a=serializeFunction(e,c,l,a,r,i,o):"Binary"===l._bsontype?a=serializeBinary(e,c,l,a):"Symbol"===l._bsontype?a=serializeSymbol(e,c,l,a):"DBRef"===l._bsontype?a=serializeDBRef(e,c,l,a,i,o):"BSONRegExp"===l._bsontype?a=serializeBSONRegExp(e,c,l,a):"Int32"===l._bsontype?a=serializeInt32(e,c,l,a):"MinKey"!==l._bsontype&&"MaxKey"!==l._bsontype||(a=serializeMinMax(e,c,l,a))}}s.pop(),e[a++]=0;var _=a-n;return e[n++]=255&_,e[n++]=_>>8&255,e[n++]=_>>16&255,e[n++]=_>>24&255,a},BSON$1={};BSON$1.BSON_DATA_NUMBER=1,BSON$1.BSON_DATA_STRING=2,BSON$1.BSON_DATA_OBJECT=3,BSON$1.BSON_DATA_ARRAY=4,BSON$1.BSON_DATA_BINARY=5,BSON$1.BSON_DATA_UNDEFINED=6,BSON$1.BSON_DATA_OID=7,BSON$1.BSON_DATA_BOOLEAN=8,BSON$1.BSON_DATA_DATE=9,BSON$1.BSON_DATA_NULL=10,BSON$1.BSON_DATA_REGEXP=11,BSON$1.BSON_DATA_CODE=13,BSON$1.BSON_DATA_SYMBOL=14,BSON$1.BSON_DATA_CODE_W_SCOPE=15,BSON$1.BSON_DATA_INT=16,BSON$1.BSON_DATA_TIMESTAMP=17,BSON$1.BSON_DATA_LONG=18,BSON$1.BSON_DATA_DECIMAL128=19,BSON$1.BSON_DATA_MIN_KEY=255,BSON$1.BSON_DATA_MAX_KEY=127,BSON$1.BSON_BINARY_SUBTYPE_DEFAULT=0,BSON$1.BSON_BINARY_SUBTYPE_FUNCTION=1,BSON$1.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,BSON$1.BSON_BINARY_SUBTYPE_UUID=3,BSON$1.BSON_BINARY_SUBTYPE_MD5=4,BSON$1.BSON_BINARY_SUBTYPE_USER_DEFINED=128,BSON$1.BSON_INT32_MAX=2147483647,BSON$1.BSON_INT32_MIN=-2147483648,BSON$1.BSON_INT64_MAX=Math.pow(2,63)-1,BSON$1.BSON_INT64_MIN=-Math.pow(2,63),BSON$1.JS_INT_MAX=9007199254740992,BSON$1.JS_INT_MIN=-9007199254740992;var serializer=serializeInto,Long$3=long_1.Long,Double$2=double_1.Double,Timestamp$2=timestamp.Timestamp,ObjectID$2=objectid.ObjectID,_Symbol$1=symbol.Symbol,BSONRegExp$2=regexp.BSONRegExp,Code$2=code.Code,MinKey$3=min_key.MinKey,MaxKey$2=max_key.MaxKey,DBRef$2=db_ref.DBRef,Binary$3=binary.Binary,normalizedFunctionString$2=utils.normalizedFunctionString,isDate$1=function(e){return"object"===(void 0===e?"undefined":_typeof(e))&&"[object Date]"===Object.prototype.toString.call(e)},calculateObjectSize=function(e,t,r){var n=5;if(Array.isArray(e))for(var i=0;i<e.length;i++)n+=calculateElement(i.toString(),e[i],t,!0,r);else{e.toBSON&&(e=e.toBSON());for(var o in e)n+=calculateElement(o,e[o],t,!1,r)}return n},BSON$2={};BSON$2.BSON_INT32_MAX=2147483647,BSON$2.BSON_INT32_MIN=-2147483648,BSON$2.JS_INT_MAX=9007199254740992,BSON$2.JS_INT_MIN=-9007199254740992;var calculate_size=calculateObjectSize,MAXSIZE=17825792,buffer=new Buffer(MAXSIZE),BSON$3=function(){};BSON$3.prototype.serialize=function(e,t){t=t||{};var r="boolean"==typeof t.checkKeys&&t.checkKeys,n="boolean"==typeof t.serializeFunctions&&t.serializeFunctions,i="boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined,o="number"==typeof t.minInternalBufferSize?t.minInternalBufferSize:MAXSIZE;buffer.length<o&&(buffer=new Buffer(o));var u=serializer(buffer,e,r,0,0,n,i,[]),s=new Buffer(u);return buffer.copy(s,0,0,s.length),s},BSON$3.prototype.serializeWithBufferAndIndex=function(e,t,r){r=r||{};var n="boolean"==typeof r.checkKeys&&r.checkKeys,i="boolean"==typeof r.serializeFunctions&&r.serializeFunctions,o="boolean"!=typeof r.ignoreUndefined||r.ignoreUndefined,u="number"==typeof r.index?r.index:0,s=serializer(buffer,e,n,0,0,i,o);return buffer.copy(t,u,0,s),u+s-1},BSON$3.prototype.deserialize=function(e,t){return deserializer(e,t)},BSON$3.prototype.calculateObjectSize=function(e,t){t=t||{};var r="boolean"==typeof t.serializeFunctions&&t.serializeFunctions,n="boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined;return calculate_size(e,r,n)},BSON$3.prototype.deserializeStream=function(e,t,r,n,i,o){o=Object.assign({allowObjectSmallerThanBufferSize:!0},o);for(var u=t,s=0;s<r;s++){var a=e[u]|e[u+1]<<8|e[u+2]<<16|e[u+3]<<24;o.index=u,n[i+s]=this.deserialize(e,o),u+=a}return u},BSON$3.BSON_INT32_MAX=2147483647,BSON$3.BSON_INT32_MIN=-2147483648,BSON$3.BSON_INT64_MAX=Math.pow(2,63)-1,BSON$3.BSON_INT64_MIN=-Math.pow(2,63),BSON$3.JS_INT_MAX=9007199254740992,BSON$3.JS_INT_MIN=-9007199254740992,BSON$3.BSON_DATA_NUMBER=1,BSON$3.BSON_DATA_STRING=2,BSON$3.BSON_DATA_OBJECT=3,BSON$3.BSON_DATA_ARRAY=4,BSON$3.BSON_DATA_BINARY=5,BSON$3.BSON_DATA_OID=7,BSON$3.BSON_DATA_BOOLEAN=8,BSON$3.BSON_DATA_DATE=9,BSON$3.BSON_DATA_NULL=10,BSON$3.BSON_DATA_REGEXP=11,BSON$3.BSON_DATA_CODE=13,BSON$3.BSON_DATA_SYMBOL=14,BSON$3.BSON_DATA_CODE_W_SCOPE=15,BSON$3.BSON_DATA_INT=16,BSON$3.BSON_DATA_TIMESTAMP=17,BSON$3.BSON_DATA_LONG=18,BSON$3.BSON_DATA_MIN_KEY=255,BSON$3.BSON_DATA_MAX_KEY=127,BSON$3.BSON_BINARY_SUBTYPE_DEFAULT=0,BSON$3.BSON_BINARY_SUBTYPE_FUNCTION=1,BSON$3.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,BSON$3.BSON_BINARY_SUBTYPE_UUID=3,BSON$3.BSON_BINARY_SUBTYPE_MD5=4,BSON$3.BSON_BINARY_SUBTYPE_USER_DEFINED=128;var bson=BSON$3,Code_1$1=code,Map_1=map,Symbol_1$1=symbol,BSON_1=BSON$3,DBRef_1$1=db_ref,Binary_1$1=binary,ObjectID_1$1=objectid,Long_1$1=long_1,Timestamp_1$1=timestamp,Double_1$1=double_1,Int32_1$1=int_32,MinKey_1$1=min_key,MaxKey_1$1=max_key,BSONRegExp_1$1=regexp,Decimal128_1$1=decimal128;bson.Code=Code_1$1,bson.Map=Map_1,bson.Symbol=Symbol_1$1,bson.BSON=BSON_1,bson.DBRef=DBRef_1$1,bson.Binary=Binary_1$1,bson.ObjectID=ObjectID_1$1,bson.Long=Long_1$1,bson.Timestamp=Timestamp_1$1,bson.Double=Double_1$1,bson.Int32=Int32_1$1,bson.MinKey=MinKey_1$1,bson.MaxKey=MaxKey_1$1,bson.BSONRegExp=BSONRegExp_1$1,bson.Decimal128=Decimal128_1$1,bson.BSON_INT32_MAX=2147483647,bson.BSON_INT32_MIN=-2147483648,bson.BSON_INT64_MAX=Math.pow(2,63)-1,bson.BSON_INT64_MIN=-Math.pow(2,63),bson.JS_INT_MAX=9007199254740992,bson.JS_INT_MIN=-9007199254740992,bson.Binary=binary,bson.Code=code,bson.DBRef=db_ref,bson.Decimal128=decimal128,bson.Double=double_1,bson.Int32=int_32,bson.Long=long_1,bson.Map=map,bson.MaxKey=max_key,bson.MinKey=min_key,bson.ObjectId=objectid,bson.ObjectID=objectid,bson.BSONRegExp=regexp,bson.Symbol=symbol,bson.Timestamp=timestamp;var jsBson=bson;return jsBson})}).call(exports,__webpack_require__(10),__webpack_require__(8).Buffer,__webpack_require__(35))},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return t?e+"?link=true":e}function u(e){return{authenticate:function(t,r){var n=e.getDeviceId(),i=e.getDeviceInfo(n,!!e.client&&e.client.clientAppID),u=y.makeFetchArgs("GET");return u.cors=!0,fetch(o(e.rootUrl+"/providers/anon-user/login?device="+(0,m.uriEncodeObject)(i),r),e.fetchArgsWithLink(u,r)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,B)})}}}function s(e){return{authenticate:function(t,r){var n=e.getDeviceId(),i=e.getDeviceInfo(n,!!e.client&&e.client.clientAppID),u=y.makeFetchArgs("POST",JSON.stringify({token:t,options:{device:i}}));return u.cors=!0,fetch(o(e.rootUrl+"/providers/custom-token/login",r),e.fetchArgsWithLink(u,r)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,S)})}}}function a(e){var t=(e.isAppClient(),"providers/local-userpass"),r=(e.isAppClient(),t+"/login");return{authenticate:function(t,n){var i=t.username,u=t.password,s=e.getDeviceId(),a=e.getDeviceInfo(s,!!e.client&&e.client.clientAppID),f=y.makeFetchArgs("POST",JSON.stringify({username:i,password:u,options:{device:a}}));return f.cors=!0,fetch(o(e.rootUrl+"/"+r,n),e.fetchArgsWithLink(f,n)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,E)})},emailConfirm:function(r,n){var i=y.makeFetchArgs("POST",JSON.stringify({tokenId:r,token:n}));return i.cors=!0,fetch(e.rootUrl+"/"+t+"/confirm",i).then(y.checkStatus).then(function(e){return e.json()})},sendEmailConfirm:function(r){var n=y.makeFetchArgs("POST",JSON.stringify({email:r}));return n.cors=!0,fetch(e.rootUrl+"/"+t+"/confirm/send",n).then(y.checkStatus).then(function(e){return e.json()})},sendPasswordReset:function(r){var n=y.makeFetchArgs("POST",JSON.stringify({email:r}));return n.cors=!0,fetch(e.rootUrl+"/"+t+"/reset/send",n).then(y.checkStatus).then(function(e){return e.json()})},passwordReset:function(r,n,i){var o=y.makeFetchArgs("POST",JSON.stringify({tokenId:r,token:n,password:i}));return o.cors=!0,fetch(e.rootUrl+"/"+t+"/reset",o).then(y.checkStatus).then(function(e){return e.json()})},register:function(r,n){var i=y.makeFetchArgs("POST",JSON.stringify({email:r,password:n}));return i.cors=!0,fetch(e.rootUrl+"/"+t+"/register",i).then(y.checkStatus).then(function(e){return e.json()})}}}function f(e){var t=(e.isAppClient(),"providers/api-key/login");return{authenticate:function(r,n){var i=e.getDeviceId(),u=e.getDeviceInfo(i,!!e.client&&e.client.clientAppID),s=y.makeFetchArgs("POST",JSON.stringify({key:r,options:{device:u}}));return s.cors=!0,fetch(o(e.rootUrl+"/"+t,n),e.fetchArgsWithLink(s,n)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,O)})}}}function c(){for(var e="",t=0;t<64;++t)e+=T.charAt(Math.floor(Math.random()*T.length));return e}function l(e,t,r){void 0===r&&(r=e.pageRootUrl());var n=c();return e.storage.set(v.STATE_KEY,n).then(function(){return e.getDeviceId()}).then(function(i){var o=e.getDeviceInfo(i,!!e.client&&e.client.clientAppID);return e.rootUrl+"/providers/oauth2-"+t+"/login?redirect="+encodeURI(r)+"&state="+n+"&device="+(0,m.uriEncodeObject)(o)})}function h(e){var t=(e.isAppClient(),"providers/oauth2-google/login");return{authenticate:function(r,n){var i=r.authCode;if(i){var u=e.getDeviceId(),s=e.getDeviceInfo(u,!!e.client&&e.client.clientAppID),a=y.makeFetchArgs("POST",JSON.stringify({authCode:i,options:{device:s}}));return fetch(o(e.rootUrl+"/"+t,n),e.fetchArgsWithLink(a,n)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,w)})}var f=r&&r.redirectUrl?r.redirectUrl:void 0;return e.storage.set(v.STITCH_REDIRECT_PROVIDER,w).then(function(){return l(e,w,f)}).then(function(e){return window.location.replace(e)})}}}function p(e){var t=(e.isAppClient(),"providers/oauth2-facebook/login");return{authenticate:function(r,n){var i=r.accessToken;if(i){var u=e.getDeviceId(),s=e.getDeviceInfo(u,!!e.client&&e.client.clientAppID),a=y.makeFetchArgs("POST",JSON.stringify({accessToken:i,options:{device:s}}));return fetch(o(e.rootUrl+"/"+t,n),e.fetchArgsWithLink(a,n)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,N)})}var f=r&&r.redirectUrl?r.redirectUrl:void 0;return e.storage.set(v.STITCH_REDIRECT_PROVIDER,N).then(function(){return l(e,N,f)}).then(function(e){return window.location.replace(e)})}}}function d(e){var t=(e.isAppClient(),"providers/mongodb-cloud/login");return{authenticate:function(r,n){var i=r.username,u=r.apiKey,s=r.cors,a=r.cookie,f=Object.assign({},{cors:!0,cookie:!1},{cors:s,cookie:a}),c=e.getDeviceId(),l=e.getDeviceInfo(c,!!e.client&&e.client.clientAppID),h=y.makeFetchArgs("POST",JSON.stringify({username:i,apiKey:u,options:{device:l}}));h.cors=!0,h.credentials="include";var p=o(e.rootUrl+"/"+t,n);return f.cookie?fetch(p+"?cookie=true",h).then(y.checkStatus):fetch(p,e.fetchArgsWithLink(h,n)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,A)})}}}function g(e){var t;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t={},i(t,B,u(e)),i(t,O,f(e)),i(t,w,h(e)),i(t,N,p(e)),i(t,A,d(e)),i(t,E,a(e)),i(t,S,s(e)),t}Object.defineProperty(t,"__esModule",{value:!0}),t.createProviders=t.PROVIDER_TYPE_MONGODB_CLOUD=t.PROVIDER_TYPE_FACEBOOK=t.PROVIDER_TYPE_GOOGLE=t.PROVIDER_TYPE_APIKEY=t.PROVIDER_TYPE_USERPASS=t.PROVIDER_TYPE_CUSTOM=t.PROVIDER_TYPE_ANON=void 0;var _=r(2),y=n(_),b=r(1),v=n(b),m=r(0),B=t.PROVIDER_TYPE_ANON="anon",S=t.PROVIDER_TYPE_CUSTOM="custom",E=t.PROVIDER_TYPE_USERPASS="userpass",O=t.PROVIDER_TYPE_APIKEY="apiKey",w=t.PROVIDER_TYPE_GOOGLE="google",N=t.PROVIDER_TYPE_FACEBOOK="facebook",A=t.PROVIDER_TYPE_MONGODB_CLOUD="mongodbCloud",T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.createProviders=g},function(e,t,r){"use strict";(function(e){function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,r){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return u(this,e,t,r)}function u(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,r,n):"string"==typeof t?c(e,t,r):p(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function a(e,t,r,n){return s(t),t<=0?i(e,t):void 0!==r?"string"==typeof n?i(e,t).fill(r,n):i(e,t).fill(r):i(e,t)}function f(e,t){if(s(t),e=i(e,t<0?0:0|d(t)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function c(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!o.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|_(t,r);e=i(e,n);var u=e.write(t,r);return u!==n&&(e=e.slice(0,u)),e}function l(e,t){var r=t.length<0?0:0|d(t.length);e=i(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function h(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=l(e,t),e}function p(e,t){if(o.isBuffer(t)){var r=0|d(t.length);return e=i(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||H(t.length)?i(e,0):l(e,t);if("Buffer"===t.type&&Z(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),o.alloc(+e)}function _(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(e).length;default:if(n)return K(e).length;t=(""+t).toLowerCase(),n=!0}}function y(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return R(this,t,r);case"latin1":case"binary":return D(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function b(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){function o(e,t){return 1===u?e[t]:e.readUInt16BE(t*u)}var u=1,s=e.length,a=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;u=2,s/=2,a/=2,r/=2}var f;if(i){var c=-1;for(f=r;f<s;f++)if(o(e,f)===o(t,-1===c?0:f-c)){if(-1===c&&(c=f),f-c+1===a)return c*u}else-1!==c&&(f-=f-c),c=-1}else for(r+a>s&&(r=s-a),f=r;f>=0;f--){for(var l=!0,h=0;h<a;h++)if(o(e,f+h)!==o(t,h)){l=!1;break}if(l)return f}return-1}function B(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var s=parseInt(t.substr(2*u,2),16);if(isNaN(s))return u;e[r+u]=s}return u}function S(e,t,r,n){return X(K(t,e.length-r),e,r,n)}function E(e,t,r,n){return X(W(t),e,r,n)}function O(e,t,r,n){return E(e,t,r,n)}function w(e,t,r,n){return X(V(t),e,r,n)}function N(e,t,r,n){return X(J(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?G.fromByteArray(e):G.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],u=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var a,f,c,l;switch(s){case 1:o<128&&(u=o);break;case 2:a=e[i+1],128==(192&a)&&(l=(31&o)<<6|63&a)>127&&(u=l);break;case 3:a=e[i+1],f=e[i+2],128==(192&a)&&128==(192&f)&&(l=(15&o)<<12|(63&a)<<6|63&f)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:a=e[i+1],f=e[i+2],c=e[i+3],128==(192&a)&&128==(192&f)&&128==(192&c)&&(l=(15&o)<<18|(63&a)<<12|(63&f)<<6|63&c)>65535&&l<1114112&&(u=l)}}null===u?(u=65533,s=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=s}return I(n)}function I(e){var t=e.length;if(t<=Q)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Q));return r}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function D(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=z(e[o]);return i}function L(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function $(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,r,n,i,u){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<u)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function x(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function M(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,i){return i||M(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),q.write(e,t,r,n,23,4),r+4}function C(e,t,r,n,i){return i||M(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),q.write(e,t,r,n,52,8),r+8}function Y(e){if(e=F(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function F(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function K(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],u=0;u<n;++u){if((r=e.charCodeAt(u))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function J(e,t){for(var r,n,i,o=[],u=0;u<e.length&&!((t-=2)<0);++u)r=e.charCodeAt(u),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function V(e){return G.toByteArray(Y(e))}function X(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function H(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var G=r(24),q=r(29),Z=r(30);t.Buffer=o,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,r){return u(null,e,t,r)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,r){return a(null,e,t,r)},o.allocUnsafe=function(e){return f(null,e)},o.allocUnsafeSlow=function(e){return f(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,u=Math.min(r,n);i<u;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var u=e[r];if(!o.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(n,i),i+=u.length}return n},o.byteLength=_,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):y.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,r,n,i){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var u=i-n,s=r-t,a=Math.min(u,s),f=this.slice(n,i),c=e.slice(t,r),l=0;l<a;++l)if(f[l]!==c[l]){u=f[l],s=c[l];break}return u<s?-1:s<u?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return B(this,e,t,r);case"utf8":case"utf-8":return S(this,e,t,r);case"ascii":return E(this,e,t,r);case"latin1":case"binary":return O(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(o.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var u=0;u<i;++u)n[u]=this[u+e]}return n},o.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return t||$(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||$(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||$(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||$(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||$(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||$(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||$(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){t||$(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return t||$(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||$(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||$(e,4,this.length),q.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||$(e,4,this.length),q.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||$(e,8,this.length),q.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||$(e,8,this.length),q.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){k(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){k(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):x(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);k(this,e,t,r,i-1,-i)}var o=0,u=1,s=0;for(this[t]=255&e;++o<r&&(u*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/u>>0)-s&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);k(this,e,t,r,i-1,-i)}var o=r-1,u=1,s=0;for(this[t+o]=255&e;--o>=0&&(u*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/u>>0)-s&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):x(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return C(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return C(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,u=n-r;if(this===e&&r<t&&t<n)for(i=u-1;i>=0;--i)e[i+t]=this[i+r];else if(u<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<u;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+u),t);return u},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var u;if("number"==typeof e)for(u=t;u<r;++u)this[u]=e;else{var s=o.isBuffer(e)?e:K(new o(e,n).toString()),a=s.length;for(u=0;u<r-t;++u)this[u+t]=s[u%a]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,r(10))},function(e,t,r){r(38);var n="undefined"!=typeof self&&self||this;e.exports=n.fetch.bind(n)},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.StitchAdminClient=t.StitchAdminClientFactory=void 0;var s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var u=i.get;if(void 0!==u)return u.call(n)},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r(9);var f=r(28),c=n(f),l=r(4),h=r(2),p=n(h),d=r(1),g=r(3),_=(t.StitchAdminClientFactory=function(){function e(){throw u(this,e),new g.StitchError("StitchAdminClient can only be made from the StitchAdminClientFactory.create function")}return a(e,null,[{key:"create",value:function(e){return(0,l.newStitchClient)(_.prototype,"",{baseUrl:e,authCodec:d.ADMIN_CLIENT_CODEC})}}]),e}(),t.StitchAdminClient=function(e){function t(){return u(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),a(t,[{key:"logout",value:function(){var e=this;return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",this).call(this,"/auth/session","DELETE",{refreshOnFailure:!1,useRefreshToken:!0,apiVersion:3}).then(function(){return e.auth.clear()})}},{key:"userProfile",value:function(){return this._v3._get("/auth/profile")}},{key:"getAuthProviders",value:function(){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",this).call(this,"/auth/providers","GET",{noAuth:!0,apiVersion:3}).then(function(e){return e.json()})}},{key:"doSessionPost",value:function(){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",this).call(this,"/auth/session","POST",{refreshOnFailure:!1,useRefreshToken:!0,apiVersion:3}).then(function(e){return e.json()})}},{key:"apps",value:function(e){var t=this._v3,r="/groups/"+e+"/apps";return{list:function(){return t._get(r)},create:function(e,n){var i=n&&n.product?"?product="+n.product:"";return t._post(r+i,e)},app:function(e){var n=r+"/"+e;return{get:function(){return t._get(n)},remove:function(){return t._delete(n)},export:function(){return t._get(n+"/export",void 0,{Accept:"application/zip"})},measurements:function(e){return t._get(n+"/measurements",e)},commands:function(){return{run:function(e,r){return t._post(n+"/commands/"+e,r)}}},values:function(){return{list:function(){return t._get(n+"/values")},create:function(e){return t._post(n+"/values",e)},value:function(e){var r=n+"/values/"+e;return{get:function(){return t._get(r)},remove:function(){return t._delete(r)},update:function(e){return t._put(r,{body:JSON.stringify(e)})}}}}},hosting:function(){return{config:function(){return{get:function(){return t._get(n+"/hosting/config")},patch:function(e){return t._patch(n+"/hosting/config",{body:JSON.stringify(e)})}}},cache:function(){return{invalidate:function(e){return t._put(n+"/hosting/cache",{body:JSON.stringify({invalidate:!0,path:e})})}}},assets:function(){return{createDirectory:function(e){return t._put(n+"/hosting/assets/asset",{body:JSON.stringify({path:e+"/"})})},list:function(e){return t._get(n+"/hosting/assets",e)},upload:function(e,r){var i=new c.default;return i.append("meta",e),i.append("file",r),t._put(n+"/hosting/assets/asset",{body:i,multipart:!0})},post:function(e){return t._post(n+"/hosting/assets",e)},asset:function(){return{patch:function(e){return t._patch(n+"/hosting/assets/asset",{body:JSON.stringify({attributes:e.attributes}),queryParams:{path:e.path}})},get:function(e){return t._get(n+"/hosting/assets/asset",e)},delete:function(e){return t._delete(n+"/hosting/assets/asset",e)}}}}}}},services:function(){return{list:function(){return t._get(n+"/services")},create:function(e){return t._post(n+"/services",e)},service:function(e){return{get:function(){return t._get(n+"/services/"+e)},remove:function(){return t._delete(n+"/services/"+e)},update:function(r){return t._patch(n+"/services/"+e,{body:JSON.stringify(r)})},runCommand:function(r,i){return t._post(n+"/services/"+e+"/commands/"+r,i)},config:function(){return{get:function(){return t._get(n+"/services/"+e+"/config")},update:function(r){return t._patch(n+"/services/"+e+"/config",{body:JSON.stringify(r)})}}},rules:function(){return{list:function(){return t._get(n+"/services/"+e+"/rules")},create:function(r){return t._post(n+"/services/"+e+"/rules",r)},rule:function(r){var i=n+"/services/"+e+"/rules/"+r;return{get:function(){return t._get(i)},update:function(e){return t._put(i,{body:JSON.stringify(e)})},remove:function(){return t._delete(i)}}}}},incomingWebhooks:function(){return{list:function(){return t._get(n+"/services/"+e+"/incoming_webhooks")},create:function(r){return t._post(n+"/services/"+e+"/incoming_webhooks",r)},incomingWebhook:function(r){var i=n+"/services/"+e+"/incoming_webhooks/"+r;return{get:function(){return t._get(i)},update:function(e){return t._put(i,{body:JSON.stringify(e)})},remove:function(){return t._delete(i)}}}}}}}}},pushNotifications:function(){return{list:function(e){return t._get(n+"/push/notifications",e)},create:function(e){return t._post(n+"/push/notifications",e)},pushNotification:function(e){return{get:function(){return t._get(n+"/push/notifications/"+e)},update:function(r){return t._put(n+"/push/notifications/"+e,{body:JSON.stringify(r)})},remove:function(){return t._delete(n+"/push/notifications/"+e)},send:function(){return t._post(n+"/push/notifications/"+e+"/send")}}}}},users:function(){return{list:function(e){return t._get(n+"/users",e)},create:function(e){return t._post(n+"/users",e)},user:function(e){return{get:function(){return t._get(n+"/users/"+e)},devices:function(){return{get:function(){return t._get(n+"/users/"+e+"/devices")}}},logout:function(){return t._put(n+"/users/"+e+"/logout")},enable:function(){return t._put(n+"/users/"+e+"/enable")},disable:function(){return t._put(n+"/users/"+e+"/disable")},remove:function(){return t._delete(n+"/users/"+e)}}}}},userRegistrations:function(){return{sendConfirmationEmail:function(e){return t._post(n+"/user_registrations/by_email/"+e+"/send_confirm")}}},debug:function(){return{executeFunction:function(e){for(var r=arguments.length,i=Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t._post(n+"/debug/execute_function",{name:u,arguments:i},{user_id:e})},executeFunctionSource:function(e){var r=e.userId,i=e.source,o=void 0===i?"":i,u=e.evalSource,s=void 0===u?"":u,a=e.runAsSystem;return t._post(n+"/debug/execute_function_source",{source:o,eval_source:s},{user_id:r,run_as_system:a})}}},authProviders:function(){return{list:function(){return t._get(n+"/auth_providers")},create:function(e){return t._post(n+"/auth_providers",e)},authProvider:function(e){return{get:function(){return t._get(n+"/auth_providers/"+e)},update:function(r){return t._patch(n+"/auth_providers/"+e,{body:JSON.stringify(r)})},enable:function(){return t._put(n+"/auth_providers/"+e+"/enable")},disable:function(){return t._put(n+"/auth_providers/"+e+"/disable")},remove:function(){return t._delete(n+"/auth_providers/"+e)}}}}},security:function(){return{allowedRequestOrigins:function(){return{get:function(){return t._get(n+"/security/allowed_request_origins")},update:function(e){return t._post(n+"/security/allowed_request_origins",e)}}}}},logs:function(){return{list:function(e){return t._get(n+"/logs",e)}}},apiKeys:function(){return{list:function(){return t._get(n+"/api_keys")},create:function(e){return t._post(n+"/api_keys",e)},apiKey:function(e){return{get:function(){return t._get(n+"/api_keys/"+e)},remove:function(){return t._delete(n+"/api_keys/"+e)},enable:function(){return t._put(n+"/api_keys/"+e+"/enable")},disable:function(){return t._put(n+"/api_keys/"+e+"/disable")}}}}},functions:function(){return{list:function(){return t._get(n+"/functions")},create:function(e){return t._post(n+"/functions",e)},function:function(e){return{get:function(){return t._get(n+"/functions/"+e)},update:function(r){return t._put(n+"/functions/"+e,{body:JSON.stringify(r)})},remove:function(){return t._delete(n+"/functions/"+e)}}}}},eventSubscriptions:function(){return{list:function(e){return t._get(n+"/event_subscriptions",e)},create:function(e){return t._post(n+"/event_subscriptions",e)},eventSubscription:function(e){return{get:function(){return t._get(n+"/event_subscriptions/"+e)},update:function(r){return t._put(n+"/event_subscriptions/"+e,{body:JSON.stringify(r)})},remove:function(){return t._delete(n+"/event_subscriptions/"+e)},resume:function(r){return t._put(n+"/event_subscriptions/"+e+"/resume",{body:JSON.stringify(r)})}}}}}}}}}},{key:"type",get:function(){return p.default}},{key:"_v3",get:function(){var e=this,r=function(r,n,i){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",e).call(e,r,n,Object.assign({},{apiVersion:3},i)).then(function(e){return(e.headers.get("content-type")||"").split(",").indexOf("application/json")>=0?e.json():e})};return{_get:function(e,t,n){return r(e,"GET",{queryParams:t,headers:n})},_put:function(e,t){return t?r(e,"PUT",t):r(e,"PUT")},_patch:function(e,t){return t?r(e,"PATCH",t):r(e,"PATCH")},_delete:function(e,t){return t?r(e,"DELETE",{queryParams:t}):r(e,"DELETE")},_post:function(e,t,n){return n?r(e,"POST",{body:JSON.stringify(t),queryParams:n}):r(e,"POST",{body:JSON.stringify(t)})}}}}]),t}(l.StitchClient))},function(e,t,r){!function(){function e(e){this.message=e}var r=t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",r.btoa||(r.btoa=function(t){for(var r,i,o=String(t),u=0,s=n,a="";o.charAt(0|u)||(s="=",u%1);a+=s.charAt(63&r>>8-u%1*8)){if((i=o.charCodeAt(u+=.75))>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|i}return a}),r.atob||(r.atob=function(t){var r=String(t).replace(/[=]+$/,"");if(r.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,o,u=0,s=0,a="";o=r.charAt(s++);~o&&(i=u%4?64*i+o:o,u++%4)?a+=String.fromCharCode(255&i>>(-2*u&6)):0)o=n.indexOf(o);return a})}()},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t,r){var n=Object.create(v.prototype),i=void 0;return i=e&&""!==e.clientAppID?"client."+e.clientAppID:"admin",r=Object.assign({codec:p.APP_CLIENT_CODEC,namespace:i,storageType:"localStorage"},r),n.client=e,n.rootUrl=t,n.codec=r.codec,n.platform=r.platform||y,n.storage=(0,f.createStorage)(r),n.providers=(0,c.createProviders)(n,r),Promise.all([n._get(),n.storage.get(p.REFRESH_TOKEN_KEY),n.storage.get(p.USER_LOGGED_IN_PT_KEY),n.storage.get(p.DEVICE_ID_KEY)]).then(function(e){var t=s(e,4),r=t[0],i=t[1],o=t[2],u=t[3];return n.auth=r,n.authedId=r.userId,n.rt=i,n.loggedInProviderType=o,n.deviceId=u,n})}Object.defineProperty(t,"__esModule",{value:!0}),t.Auth=t.AuthFactory=void 0;var s=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(n=(u=s.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.newAuth=u;var f=r(14),c=r(7),l=r(3),h=r(1),p=n(h),d=r(2),g=n(d),_=r(25),y=n(_),b=r(33),v=(t.AuthFactory=function(){function e(){throw o(this,e),new l.StitchError("Auth can only be made from the AuthFactory.create function")}return a(e,null,[{key:"create",value:function(e,t,r){return u(e,t,r)}}]),e}(),t.Auth=function(){function e(t,r,n){throw o(this,e),new l.StitchError("Auth can only be made from the AuthFactory.create function")}return a(e,[{key:"getDeviceInfo",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n={appId:t,appVersion:r,sdkVersion:g.SDK_VERSION};return e&&(n.deviceId=e),this.platform&&(n.platform=this.platform.name,n.platformVersion=this.platform.version),n}},{key:"provider",value:function(e){if(!this.providers.hasOwnProperty(e))throw new Error("Invalid auth provider specified: "+e);return this.providers[e]}},{key:"refreshToken",value:function(){var e=this;return this.client.doSessionPost().then(function(t){return e.set(t)})}},{key:"pageRootUrl",value:function(){return[window.location.protocol,"//",window.location.host,window.location.pathname].join("")}},{key:"error",value:function(){return this._error}},{key:"isAppClient",value:function(){return!this.client||this.client.type===g.APP_CLIENT_TYPE}},{key:"handleRedirect",value:function(){var e=this;if("undefined"!=typeof window&&window.location&&window.location.hash)return Promise.all([this.storage.get(p.STATE_KEY),this.storage.get(p.STITCH_REDIRECT_PROVIDER)]).then(function(t){var r=s(t,2),n=r[0],i=r[1],o=window.location.hash.substring(1),u=e.parseRedirectFragment(o,n);return u.lastError||u.found&&!i?(console.error("StitchClient: error from redirect: "+(u.lastError?u.lastError:"provider type not set")),e._error=u.lastError,window.history.replaceState(null,"",e.pageRootUrl()),Promise.reject()):u.found?Promise.all([e.storage.remove(p.STATE_KEY),e.storage.remove(p.STITCH_REDIRECT_PROVIDER)]).then(function(){return{redirectState:u,redirectProvider:i}}):Promise.reject()}).then(function(t){var r=t.redirectState,n=t.redirectProvider;return r.stateValid?r.ua?e.set(r.ua,n):void console.error("StitchClient: no UA value was returned from redirect!"):(console.error("StitchClient: state values did not match!"),void window.history.replaceState(null,"",e.pageRootUrl()))}).then(function(){return window.history.replaceState(null,"",e.pageRootUrl())}).catch(function(e){if(e)throw e})}},{key:"getCookie",value:function(e){for(var t=document.cookie.split(" "),r=0;r<t.length;r++){var n=t[r],i=n.indexOf("=");if(n.substring(0,i)===e){var o=n.substring(i+1,n.length);return";"===o[o.length-1]?o.substring(0,o.length-1):o}}}},{key:"handleCookie",value:function(){var e=this;if("undefined"!=typeof window&&"undefined"!=typeof document&&document.cookie){var t=this.getCookie(p.USER_AUTH_COOKIE_NAME);if(t){document.cookie=p.USER_AUTH_COOKIE_NAME+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT;";var r=this.unmarshallUserAuth(t);return this.set(r,c.PROVIDER_TYPE_MONGODB_CLOUD).then(function(){return window.history.replaceState(null,"",e.pageRootUrl())})}}}},{key:"clear",value:function(){return this.auth=null,this.authedId=null,this.rt=null,this.loggedInProviderType=null,Promise.all([this.storage.remove(p.USER_AUTH_KEY),this.storage.remove(p.REFRESH_TOKEN_KEY),this.storage.remove(p.USER_LOGGED_IN_PT_KEY),this.storage.remove(p.STITCH_REDIRECT_PROVIDER)])}},{key:"getDeviceId",value:function(){return this.deviceId}},{key:"isAccessTokenExpired",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.DEFAULT_ACCESS_TOKEN_EXPIRE_WITHIN_SECS,t=this.getAccessToken();if(!t)return!1;var r=void 0;try{r=b(t)}catch(e){return!1}return!!r&&(r.exp&&Math.floor(Date.now()/1e3)>=r.exp-e)}},{key:"getAccessToken",value:function(){return this.auth.accessToken}},{key:"getRefreshToken",value:function(){return this.rt}},{key:"set",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e){var n={},i=[];return r&&(this.loggedInProviderType=r,i.push(this.storage.set(p.USER_LOGGED_IN_PT_KEY,r))),e[this.codec.refreshToken]&&(this.rt=e[this.codec.refreshToken],delete e[this.codec.refreshToken],i.push(this.storage.set(p.REFRESH_TOKEN_KEY,this.rt))),e[this.codec.deviceId]&&(this.deviceId=e[this.codec.deviceId],delete e[this.codec.deviceId],i.push(this.storage.set(p.DEVICE_ID_KEY,this.deviceId))),e[this.codec.accessToken]&&(n.accessToken=e[this.codec.accessToken]),e[this.codec.userId]&&(n.userId=e[this.codec.userId]),this.auth=Object.assign(this.auth?this.auth:{},n),this.authedId=this.auth.userId,i.push(this.storage.set(p.USER_AUTH_KEY,JSON.stringify(this.auth))),Promise.all(i).then(function(){return t.auth})}}},{key:"_get",value:function(){var e=this;return this.storage.get(p.USER_AUTH_KEY).then(function(t){if(!t)return{};try{return JSON.parse(t)}catch(t){return e.clear().then(function(){throw new l.StitchError("Failure retrieving stored auth")})}})}},{key:"getLoggedInProviderType",value:function(){return this.loggedInProviderType}},{key:"parseRedirectFragment",value:function(e,t){for(var r=e.split("&"),n={ua:null,found:!1,stateValid:!1,lastError:null},i=!1,o=0;o<r.length&&!i;++o){var u=r[o].split("=");switch(decodeURIComponent(u[0])){case p.STITCH_ERROR_KEY:n.lastError=decodeURIComponent(u[1]),n.found=!0,i=!0;break;case p.USER_AUTH_KEY:try{n.ua=this.unmarshallUserAuth(decodeURIComponent(u[1])),n.found=!0}catch(e){n.lastError=e}continue;case p.STITCH_LINK_KEY:n.found=!0;continue;case p.STATE_KEY:n.found=!0;var s=decodeURIComponent(u[1]);t&&t===s&&(n.stateValid=!0);continue;default:continue}}return n}},{key:"unmarshallUserAuth",value:function(e){var t,r=e.split("$");if(4!==r.length)throw new RangeError("invalid user auth data provided: "+e);return t={},i(t,this.codec.accessToken,r[0]),i(t,this.codec.refreshToken,r[1]),i(t,this.codec.userId,r[2]),i(t,this.codec.deviceId,r[3]),t}},{key:"fetchArgsWithLink",value:function(e,t){return t&&(e.headers.Authorization="Bearer "+this.getAccessToken()),e}}]),e}())},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){switch(e){case null:case void 0:var r=[s.USER_AUTH_KEY,s.REFRESH_TOKEN_KEY,s.DEVICE_ID_KEY,s.STATE_KEY].map(function(e){return Promise.resolve(t.store.getItem(e)).then(function(r){return!!r&&t.store.setItem(t._generateKey(e),r)}).then(function(){return t.store.removeItem(e)})});return Promise.all(r).then(function(){return t.store.setItem(c,f)})}}function o(e){var t=e.storageType,r=e.storage,n=e.namespace;if("localStorage"===t){if("undefined"!=typeof window&&"localStorage"in window&&null!==window.localStorage)return new l(window.localStorage,n)}else if("sessionStorage"===t){if("undefined"!=typeof window&&"sessionStorage"in window&&null!==window.sessionStorage)return new l(window.sessionStorage,n)}else if("customStorage"==t)return new l(r,n);return new l(new a,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryStorage=void 0;var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.createStorage=o;var s=r(1),a=t.MemoryStorage=function(){function e(){n(this,e),this._data={},this._orderedKeys=[],this.length=0}return u(e,[{key:"getItem",value:function(e){return e in this._data?this._data[e]:null}},{key:"setItem",value:function(e,t){return this._orderedKeys.push(e),this._data[e]=t,this.length++,this._data[e]}},{key:"removeItem",value:function(e){this._orderedKeys.pop(e),delete this._data[e],this.length--}},{key:"key",value:function(e){return this._orderedKeys[e]}}]),e}(),f=1,c="__stitch_storage_version__",l=function(){function e(t,r){var o=this;n(this,e),this.store=t,this.namespace="_stitch."+r,this._migration=Promise.resolve(this.store.getItem(c)).then(function(e){return i(e,o)})}return u(e,[{key:"_generateKey",value:function(e){return this.namespace+"."+e}},{key:"get",value:function(e){var t=this;return Promise.resolve(this._migration).then(function(){return t.store.getItem(t._generateKey(e))})}},{key:"set",value:function(e,t){var r=this;return Promise.resolve(this._migration).then(function(){return r.store.setItem(r._generateKey(e),t)}).then(function(){return t})}},{key:"remove",value:function(e){var t=this;return Promise.resolve(this._migration).then(function(){return t.store.removeItem(t._generateKey(e))})}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BSON=t.StitchAdminClientFactory=t.StitchClientFactory=void 0;var n=r(4),i=r(11),o=r(5);t.StitchClientFactory=n.StitchClientFactory,t.StitchAdminClientFactory=i.StitchAdminClientFactory,t.BSON=o.BSON},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),u=function(){function e(t,r){n(this,e),this.client=t,this.serviceName=r}return i(e,[{key:"put",value:function(e,t,r,n,i){return(0,o.serviceResponse)(this,{action:"put",args:{bucket:e,key:t,acl:r,contentType:n,body:i}})}},{key:"signPolicy",value:function(e,t,r,n){return(0,o.serviceResponse)(this,{action:"signPolicy",args:{bucket:e,key:t,acl:r,contentType:n}})}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),u=function(){function e(t,r){n(this,e),this.client=t,this.serviceName=r}return i(e,[{key:"send",value:function(e,t,r,n){return(0,o.serviceResponse)(this,{action:"send",args:{fromAddress:e,toAddress:t,subject:r,body:n}})}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var r=void 0;return"string"!=typeof e?r=e:(r={url:e},t.authUrl&&(r.authUrl=t.authUrl)),r}function o(e,t,r){return(0,s.serviceResponse)(t,{action:e,args:r})}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),a=function(){function e(t,r){n(this,e),this.client=t,this.serviceName=r}return u(e,[{key:"get",value:function(e){return o("get",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"post",value:function(e){return o("post",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"put",value:function(e){return o("put",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"patch",value:function(e){return o("patch",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"delete",value:function(e){return o("delete",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"head",value:function(e){return o("head",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(16),o=n(i),u=r(17),s=n(u),a=r(18),f=n(a),c=r(22),l=n(c),h=r(23),p=n(h);t.default={"aws-s3":o.default,"aws-ses":s.default,aws_s3:o.default,aws_ses:s.default,http:f.default,mongodb:l.default,twilio:p.default},e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=t?"updateMany":"updateOne",u=void 0;return!t&&i.upsert&&(u={upsert:!0}),a(o,e,s(e,{query:r,update:n},u))}function o(e){var t=e.service;return a("find",t,s(t,{query:e.query,project:e.project,limit:e.limit,sort:e.sort}))}function u(e,t){return a("aggregate",e,s(e,{pipeline:t}))}function s(e,t){var r=e.db.name,n=e.name,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.assign({database:r,collection:n},t,i)}function a(e,t,r){return(0,l.serviceResponse)(t.db,{serviceName:t.db.service,action:e,args:r})}function f(e,t,r){return this instanceof f?(this.service=e,this.query=t,this.project=r,this):new f(e,t,r)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),h=function(){function e(t,r){n(this,e),this.db=t,this.name=r}return c(e,[{key:"insertOne",value:function(e){return a("insertOne",this,s(this,{document:e}))}},{key:"insertMany",value:function(e){return a("insertMany",this,s(this,{documents:Array.isArray(e)?e:[e]}))}},{key:"deleteOne",value:function(e){return a("deleteOne",this,s(this,{query:e}))}},{key:"deleteMany",value:function(e){return a("deleteMany",this,s(this,{query:e}))}},{key:"updateOne",value:function(e,t){return i(this,!1,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}},{key:"updateMany",value:function(e,t){return i(this,!0,e,t)}},{key:"find",value:function(e,t){return new f(this,e,t)}},{key:"findOne",value:function(e,t){return a("findOne",this,s(this,{query:e,project:t}))}},{key:"aggregate",value:function(e){return u(this,e)}},{key:"count",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=void 0;return t.limit&&(r={limit:t.limit}),a("count",this,s(this,{count:!0,query:e},r))}}]),e}();f.prototype.limit=function(e){return this.limit=e,this},f.prototype.sort=function(e){return this.sort=e,this},f.prototype.execute=function(e){return o(this)},t.default=h,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(20),u=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,r,i){n(this,e),this.client=t,this.service=r,this.name=i}return i(e,[{key:"collection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new u.default(this,e,t)}}]),e}();t.default=s,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(21),u=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,r){n(this,e),this.stitchClient=t,this.serviceName=r}return i(e,[{key:"db",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new u.default(this.stitchClient,this.serviceName,e)}}]),e}();t.default=s,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),u=function(){function e(t,r){n(this,e),this.client=t,this.serviceName=r}return i(e,[{key:"send",value:function(e,t,r){return(0,o.serviceResponse)(this,{action:"send",args:{from:e,to:t,body:r}})}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function i(e){var t=n(e),r=t[0],i=t[1];return 3*(r+i)/4-i}function o(e,t,r){return 3*(t+r)/4-r}function u(e){for(var t,r=n(e),i=r[0],u=r[1],s=new h(o(e,i,u)),a=0,f=u>0?i-4:i,c=0;c<f;c+=4)t=l[e.charCodeAt(c)]<<18|l[e.charCodeAt(c+1)]<<12|l[e.charCodeAt(c+2)]<<6|l[e.charCodeAt(c+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;return 2===u&&(t=l[e.charCodeAt(c)]<<2|l[e.charCodeAt(c+1)]>>4,s[a++]=255&t),1===u&&(t=l[e.charCodeAt(c)]<<10|l[e.charCodeAt(c+1)]<<4|l[e.charCodeAt(c+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t),s}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function a(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(s(n));return i.join("")}function f(e){for(var t,r=e.length,n=r%3,i=[],o=0,u=r-n;o<u;o+=16383)i.push(a(e,o,o+16383>u?u:o+16383));return 1===n?(t=e[r-1],i.push(c[t>>2]+c[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(c[t>>10]+c[t>>4&63]+c[t<<2&63]+"=")),i.join("")}t.byteLength=i,t.toByteArray=u,t.fromByteArray=f;for(var c=[],l=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,g=p.length;d<g;++d)c[d]=p[d],l[p.charCodeAt(d)]=d;l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},function(e,t,r){var n,i=r(26);"undefined"!=typeof navigator&&navigator&&(n=navigator.userAgent),e.exports=i(n)},function(e,t,r){var n=r(27);e.exports=function(e){return e?[["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/]].map(function(t){if(t[1].test(e)){var r=t[1].exec(e),i=r&&r[1].split(/[._]/).slice(0,3);return i&&i.length<3&&Array.prototype.push.apply(i,1==i.length?[0,0]:[0]),{name:t[0],version:i.join("."),os:n(e)}}}).filter(Boolean).shift():null}},function(e,t){e.exports=function(e){var t=[{name:"iOS",rule:/iP(hone|od|ad)/},{name:"Android OS",rule:/Android/},{name:"BlackBerry OS",rule:/BlackBerry|BB10/},{name:"Windows Mobile",rule:/IEMobile/},{name:"Amazon OS",rule:/Kindle/},{name:"Windows 3.11",rule:/Win16/},{name:"Windows 95",rule:/(Windows 95)|(Win95)|(Windows_95)/},{name:"Windows 98",rule:/(Windows 98)|(Win98)/},{name:"Windows 2000",rule:/(Windows NT 5.0)|(Windows 2000)/},{name:"Windows XP",rule:/(Windows NT 5.1)|(Windows XP)/},{name:"Windows Server 2003",rule:/(Windows NT 5.2)/},{name:"Windows Vista",rule:/(Windows NT 6.0)/},{name:"Windows 7",rule:/(Windows NT 6.1)/},{name:"Windows 8",rule:/(Windows NT 6.2)/},{name:"Windows 8.1",rule:/(Windows NT 6.3)/},{name:"Windows 10",rule:/(Windows NT 10.0)/},{name:"Windows ME",rule:/Windows ME/},{name:"Open BSD",rule:/OpenBSD/},{name:"Sun OS",rule:/SunOS/},{name:"Linux",rule:/(Linux)|(X11)/},{name:"Mac OS",rule:/(Mac_PowerPC)|(Macintosh)/},{name:"QNX",rule:/QNX/},{name:"BeOS",rule:/BeOS/},{name:"OS/2",rule:/OS\/2/},{name:"Search Bot",rule:/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/}],r=t.filter(function(t){if(e.match(t.rule))return!0});return r&&r[0]?r[0].name:null}},function(e,t){e.exports="object"==typeof self?self.FormData:window.FormData},function(e,t){t.read=function(e,t,r,n,i){var o,u,s=8*i-n-1,a=(1<<s)-1,f=a>>1,c=-7,l=r?i-1:0,h=r?-1:1,p=e[t+l];for(l+=h,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+e[t+l],l+=h,c-=8);for(u=o&(1<<-c)-1,o>>=-c,c+=n;c>0;u=256*u+e[t+l],l+=h,c-=8);if(0===o)o=1-f;else{if(o===a)return u?NaN:1/0*(p?-1:1);u+=Math.pow(2,n),o-=f}return(p?-1:1)*u*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var u,s,a,f=8*o-i-1,c=(1<<f)-1,l=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,u=c):(u=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-u))<1&&(u--,a*=2),t+=u+l>=1?h/a:h*Math.pow(2,1-l),t*a>=2&&(u++,a/=2),u+l>=c?(s=0,u=c):u+l>=1?(s=(t*a-1)*Math.pow(2,i),u+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,i),u=0));i>=8;e[r+p]=255&s,p+=d,s/=256,i-=8);for(u=u<<i|s,f+=i;f>0;e[r+p]=255&u,p+=d,u/=256,f-=8);e[r+p-d]|=128*g}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){function r(e){this.message=e}function n(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,u=0,s=0,a="";o=t.charAt(s++);~o&&(n=u%4?64*n+o:o,u++%4)?a+=String.fromCharCode(255&n>>(-2*u&6)):0)o=i.indexOf(o);return a}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||n},function(e,t,r){function n(e){return decodeURIComponent(i(e).replace(/(.)/g,function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}var i=r(31);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return n(t)}catch(e){return i(t)}}},function(e,t,r){"use strict";function n(e){this.message=e}var i=r(32);n.prototype=new Error,n.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new n("Invalid token specified");t=t||{};var r=!0===t.header?0:1;try{return JSON.parse(i(e.split(".")[r]))}catch(e){throw new n("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=n},function(e,t,r){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,s,a=n(e),f=1;f<arguments.length;f++){r=Object(arguments[f]);for(var c in r)o.call(r,c)&&(a[c]=r[c]);if(i){s=i(r);for(var l=0;l<s.length;l++)u.call(r,s[l])&&(a[s[l]]=r[s[l]])}}return a}},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function u(){g&&p&&(g=!1,p.length?d=p.concat(d):_=-1,d.length&&s())}function s(){if(!g){var e=i(u);g=!0;for(var t=d.length;t;){for(p=d,d=[];++_<t;)p&&p[_].run();_=-1,t=d.length}p=null,g=!1,o(e)}}function a(e,t){this.fun=e,this.array=t}function f(){}var c,l,h=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var p,d=[],g=!1,_=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new a(e,t)),1!==d.length||g||i(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=f,h.addListener=f,h.once=f,h.off=f,h.removeListener=f,h.removeAllListeners=f,h.emit=f,h.prependListener=f,h.prependOnceListener=f,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,r){"use strict";function n(e){switch(e.arrayFormat){case"index":return function(t,r,n){return null===r?[o(t,e),"[",n,"]"].join(""):[o(t,e),"[",o(n,e),"]=",o(r,e)].join("")};case"bracket":return function(t,r){return null===r?o(t,e):[o(t,e),"[]=",o(r,e)].join("")};default:return function(t,r){return null===r?o(t,e):[o(t,e),"=",o(r,e)].join("")}}}function i(e){var t;switch(e.arrayFormat){case"index":return function(e,r,n){if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t)return void(n[e]=r);void 0===n[e]&&(n[e]={}),n[e][t[1]]=r};case"bracket":return function(e,r,n){return t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0===n[e]?void(n[e]=[r]):void(n[e]=[].concat(n[e],r)):void(n[e]=r)};default:return function(e,t,r){if(void 0===r[e])return void(r[e]=t);r[e]=[].concat(r[e],t)}}}function o(e,t){return t.encode?t.strict?s(e):encodeURIComponent(e):e}function u(e){return Array.isArray(e)?e.sort():"object"==typeof e?u(Object.keys(e)).sort(function(e,t){return Number(e)-Number(t)}).map(function(t){return e[t]}):e}var s=r(37),a=r(34);t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e,t){t=a({arrayFormat:"none"},t);var r=i(t),n=Object.create(null);return"string"!=typeof e?n:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),r(decodeURIComponent(i),o,n)}),Object.keys(n).sort().reduce(function(e,t){var r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=u(r):e[t]=r,e},Object.create(null))):n},t.stringify=function(e,t){t=a({encode:!0,strict:!0,arrayFormat:"none"},t);var r=n(t);return e?Object.keys(e).sort().map(function(n){var i=e[n];if(void 0===i)return"";if(null===i)return o(n,t);if(Array.isArray(i)){var u=[];return i.slice().forEach(function(e){void 0!==e&&u.push(r(n,e,u.length))}),u.join("&")}return o(n,t)+"="+o(i,t)}).filter(function(e){return e.length>0}).join("&"):""}},function(e,t,r){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},function(e,t){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return y.iterable&&(t[Symbol.iterator]=function(){return t}),t}function i(e){this.map={},e instanceof i?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function o(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function u(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function s(e){var t=new FileReader,r=u(t);return t.readAsArrayBuffer(e),r}function a(e){var t=new FileReader,r=u(t);return t.readAsText(e),r}function f(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}function c(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(y.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(y.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(y.arrayBuffer&&y.blob&&v(e))this._bodyArrayBuffer=c(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!m(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return a(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(f(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(e){var t=e.toUpperCase();return B.indexOf(t)>-1?t:e}function p(e,t){t=t||{};var r=t.body;if(e instanceof p){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new i(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new i(t.headers)),this.method=h(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function d(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function g(e){var t=new i;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}}),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new i(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var y={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(y.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=function(e){return e&&DataView.prototype.isPrototypeOf(e)},m=ArrayBuffer.isView||function(e){return e&&b.indexOf(Object.prototype.toString.call(e))>-1};i.prototype.append=function(e,n){e=t(e),n=r(n);var i=this.map[e];this.map[e]=i?i+","+n:n},i.prototype.delete=function(e){delete this.map[t(e)]},i.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},i.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},i.prototype.set=function(e,n){this.map[t(e)]=r(n)},i.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},i.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),n(e)},i.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),n(e)},i.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),n(e)},y.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var B=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},l.call(p.prototype),l.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];_.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.Headers=i,e.Request=p,e.Response=_,e.fetch=function(e,t){return new Promise(function(r,n){var i=new p(e,t),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:g(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;r(new _(t,e))},o.onerror=function(){n(new TypeError("Network request failed"))},o.ontimeout=function(){n(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&y.blob&&(o.responseType="blob"),i.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)}])});
//# sourceMappingURL=stitch.min.js.map